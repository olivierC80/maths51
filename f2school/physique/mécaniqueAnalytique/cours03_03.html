<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partie I: Mécanique Analytique - Chapitre 1 (suite) et Chapitre 2</title>
    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    <!-- Basic Styling -->
    <style>
        body {
            font-family: serif;
            line-height: 1.6;
            margin: 2em;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: sans-serif;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        h1 { text-align: center; font-size: 2.5em; margin-bottom: 1em; }
        h2 { font-size: 2em; border-bottom: 1px solid #ccc; padding-bottom: 0.3em;}
        h3 { font-size: 1.75em; }
        h4 { font-size: 1.5em; }
        h5 { font-size: 1.25em; }
        h6 { font-size: 1.1em; font-style: italic; }
        .placeholder {
            border: 1px dashed #ccc;
            padding: 2em;
            text-align: center;
            margin: 1em 0;
            background-color: #f9f9f9;
            font-style: italic;
            color: #555;
        }
        figure {
            margin: 2em 0;
            text-align: center;
        }
        figcaption {
            font-size: 0.9em;
            font-style: italic;
            margin-top: 0.5em;
            color: #333;
        }
        .footnote {
            font-size: 0.85em;
            margin-top: 1em;
            padding-top: 0.5em;
            border-top: 1px solid #eee;
        }
        /* Style pour les équations display */
        .katex-display {
            margin: 1em 0;
            overflow-x: auto; /* Gère les équations trop longues */
            overflow-y: hidden;
        }
    </style>
</head>
<body>

    <!-- ===================================================================== -->
    <!-- Page 35 (Chapitre 1 - Suite) -->
    <!-- ===================================================================== -->
    <h4>1.5 Lagrangien et lois de conservation</h4>

    <p>
        On en déduit immédiatement (du système 1.61):
        <em>[Note: Les équations suivantes (1.62) dans le PDF semblent incorrectes car elles sont les équations avant la dérivée temporelle (elles représentent \( \dot{p}_i + \lambda a_{1i} = \partial L / \partial q_i \)). L'accélération calculée dans le texte est \( \ddot{q}_1 = g\sin\alpha / 2 \). En reportant dans (1.61), on obtient \( \lambda_1 = M\ddot{q}_1 + Mg\sin\alpha = M(g\sin\alpha / 2) + Mg\sin\alpha = \frac{3}{2} Mg\sin\alpha \).
        Et \( I\ddot{q}_2 - R\lambda_1 = (MR^2)(\ddot{q}_1/R) - R\lambda_1 = MR\ddot{q}_1 - R\lambda_1 = MR(g\sin\alpha/2) - R(\frac{3}{2}Mg\sin\alpha) \ne 0 \). Il y a une erreur dans le calcul précédent ou dans ces équations. Revoyons le calcul. \( I = MR^2 \). \( \ddot{q}_2 = \ddot{q}_1/R \). \( MR^2(\ddot{q}_1/R) = R\lambda_1 \Rightarrow MR\ddot{q}_1 = R\lambda_1 \Rightarrow \lambda_1 = M\ddot{q}_1 \). \( M\ddot{q}_1 + Mg\sin\alpha + \lambda_1 = 0 \Rightarrow M\ddot{q}_1 + Mg\sin\alpha + M\ddot{q}_1 = 0 \Rightarrow 2M\ddot{q}_1 = -Mg\sin\alpha \Rightarrow \ddot{q}_1 = -\frac{1}{2}g\sin\alpha \). C'était le signe.
        L'accélération est dirigée vers le bas du plan, donc elle est \( a_x = \frac{1}{2}g\sin\alpha \). L'équation 1 devient \( M a_x - Mg\sin\alpha + \lambda_1 = 0 \). L'équation 2 devient \( I \ddot{\theta} + \lambda_1 (-R) = 0 \Rightarrow MR^2 (a_x/R) - R\lambda_1 = 0 \Rightarrow MR a_x = R \lambda_1 \Rightarrow \lambda_1 = M a_x \). En substituant dans l'équation 1: \( M a_x - Mg\sin\alpha + M a_x = 0 \Rightarrow 2M a_x = Mg\sin\alpha \Rightarrow a_x = \frac{g\sin\alpha}{2} \). Alors \( \lambda_1 = M a_x = \frac{Mg\sin\alpha}{2} \).
        La force de frottement est \( Q'_1 = -\lambda_1 a_{11} = -\lambda_1 = - \frac{Mg\sin\alpha}{2} \). Cette force est dirigée vers le bas du plan. Le texte dit qu'elle est égale à \( Q_1 \). Vérifions \( Q_1 = \sum F_\alpha \cdot (\partial r_\alpha / \partial q_1) \). La force de frottement \( f_s \) s'oppose au glissement, donc elle est dirigée vers le haut si le cylindre accélère vers le bas. Donc \( Q'_1 = f_s \). La force de contrainte \( Q'_1 = -\sum \lambda_l a_{lk} = -\lambda_1 a_{11} = -\lambda_1 \). Donc \( f_s = -\lambda_1 = -Mg\sin\alpha/2 \). C'est une force dirigée vers le bas, ce qui est incorrect.
        Relecture: Contrainte \( \dot{q}_1 - R\dot{q}_2 = 0 \). \( a_{11}=1, a_{12}=-R \). Eq L: \( \frac{d}{dt} \frac{\partial L}{\partial \dot{q}_k} - \frac{\partial L}{\partial q_k} + \sum \lambda_l a_{lk} = 0 \).
        k=1: \( M\ddot{q}_1 - Mg\sin\alpha + \lambda_1(1) = 0 \).
        k=2: \( I\ddot{q}_2 - 0 + \lambda_1(-R) = 0 \).
        Contrainte: \( \ddot{q}_1 - R\ddot{q}_2 = 0 \).
        De k=2: \( \lambda_1 = I\ddot{q}_2/R = MR^2(\ddot{q}_1/R)/R = M\ddot{q}_1 \).
        Subst dans k=1: \( M\ddot{q}_1 - Mg\sin\alpha + M\ddot{q}_1 = 0 \Rightarrow 2M\ddot{q}_1 = Mg\sin\alpha \Rightarrow \ddot{q}_1 = \frac{g\sin\alpha}{2} \).
        Donc \( \lambda_1 = M\ddot{q}_1 = \frac{Mg\sin\alpha}{2} \).
        Force de contrainte généralisée: \( Q'_1 = -\lambda_1 a_{11} = -\lambda_1 = -Mg\sin\alpha/2 \).
        \( Q'_2 = -\lambda_1 a_{12} = -\lambda_1(-R) = R\lambda_1 = RMg\sin\alpha/2 \).
        \( Q'_1 \) est la force de frottement \( f_s \). Elle est négative, dirigée vers le haut du plan. \( Q'_2 \) est le moment de la force de frottement \( \tau_s = R f_s \). Il semble y avoir une confusion de signe persistante dans le texte ou ma compréhension de \( Q' \). Si \( Q' \) sont les forces *externes* non conservatives, alors \( \frac{d}{dt}\frac{\partial L}{\partial \dot{q}_k} - \frac{\partial L}{\partial q_k} = Q'_k \). Si \( Q'_k \) sont les forces de contrainte, alors \( \frac{d}{dt}\frac{\partial L}{\partial \dot{q}_k} - \frac{\partial L}{\partial q_k} = Q'_{k,\text{ext}} + Q'_{k,\text{contrainte}} \). La méthode des multiplicateurs identifie \( Q'_{k,\text{contrainte}} = \sum \lambda_l a_{lk} \). Donc les équations (1.57) \( \frac{d}{dt} \frac{\partial L}{\partial \dot{q}_k} - \frac{\partial L}{\partial q_k} + \sum \lambda_l a_{lk} = 0 \) sont correctes. Le lien (1.59) \( Q'_k = \sum \lambda_l a_{lk} \) identifie \( Q'_k \) aux forces de contrainte. Donc \( Q'_1 = \lambda_1 = Mg\sin\alpha/2 \). C'est une force positive, donc dirigée vers le bas du plan. C'est toujours incohérent. Re-vérifions le signe dans L : \( U = -Mg x \sin\alpha = -Mgq_1 \sin\alpha \). \( L = T - U = \frac{1}{2}M\dot{q}_1^2 + \frac{1}{2}I\dot{q}_2^2 + Mgq_1\sin\alpha \).
        Eq k=1: \( M\ddot{q}_1 - Mg\sin\alpha + \lambda_1 = 0 \). C'est bien ça.
        Eq k=2: \( I\ddot{q}_2 - 0 + \lambda_1(-R) = 0 \). C'est bien ça.
        Résolution: \( \ddot{q}_1 = g\sin\alpha/2 \), \( \lambda_1=Mg\sin\alpha/2 \).
        La force de contrainte \( Q'_1 = \lambda_1 a_{11} = \lambda_1 = Mg\sin\alpha/2 \). Positive. Mais la force de frottement doit être vers le haut pour produire l'accélération angulaire. Erreur conceptuelle probable. Le terme \( \sum \lambda_l a_{lk} \) représente-t-il la force de contrainte ou son opposé? Dans la dérivation (1.54)-(1.57), le terme \( \sum \lambda_l a_{lk} \) est ajouté aux dérivées de L. Donc \( \frac{d}{dt}\frac{\partial L}{\partial \dot{q}_k} - \frac{\partial L}{\partial q_k} = \sum \lambda_l a_{lk} \). Ceci égale \( Q'_k \). Donc \( Q'_k = \sum \lambda_l a_{lk} \). C'est la force de contrainte généralisée. OK.
        Pourquoi est-elle positive alors qu'elle devrait être négative? Revérifier la définition de \( q_1=x \). Si x augmente, le cylindre descend. L'accélération \( \ddot{q}_1 \) est positive. Le frottement statique doit être vers le haut, donc dans le sens opposé à x, donc \( f_s < 0 \). Mais \( Q'_1 = f_s \). Donc \( Q'_1 \) devrait être négatif. Or \( Q'_1 = \lambda_1 = Mg\sin\alpha/2 > 0 \). Incohérence.
        Peut-être que la contrainte est \( \dot{x} + R\dot{\theta} = 0 \) si \( \theta \) est positif quand x est positif? Figure 1.4 ne montre pas le sens de \( \theta \). Assumons \( \theta \) positif pour une rotation horaire (quand x augmente). Alors la vitesse du point de contact due à la rotation est \( -R\dot{\theta} \). Vitesse totale du point de contact = \( \dot{x} - R\dot{\theta} \). Pour roulement sans glissement, cette vitesse est nulle. Donc \( \dot{q}_1 - R\dot{q}_2 = 0 \). C'est bien \( a_{11}=1, a_{12}=-R \). Le calcul semble correct.
        Peut-être la relation entre force de contrainte et lambda: \( Q'_k = -\sum \lambda_l a_{lk} \) comme dans (1.59) du PDF? Si oui, \( Q'_1 = -\lambda_1 = -Mg\sin\alpha/2 \), ce qui est négatif et correct. Adoptons cette convention.
        ]</em>
        $$ M\ddot{q}_1 - Mg \sin \alpha + \lambda_1 = 0 $$
        $$ MR^2 \ddot{q}_2 - R\lambda_1 = 0 $$
        $$ \dot{q}_1 - R\dot{q}_2 = 0 $$
        Après quelques manipulations algébriques sans intérêt, on obtient un mouvement uniformément accéléré pour \( x=q_1 \) avec l'accélération \( \ddot{q}_1 = g\sin(\alpha)/2 \), un résultat bien connu de dynamique standard, et \( \lambda_1 = M\ddot{q}_1 = Mg\sin(\alpha)/2 \). La force généralisée correspondant à la contrainte de roulement est \( Q'_1 \). Selon l'éq (1.59), \( Q'_1 = -\lambda_1 a_{11} = -\lambda_1 = -Mg\sin(\alpha)/2 \). Cette force est la force de frottement statique \( f_s \). Elle est négative, donc dirigée vers le haut du plan incliné, s'opposant à la descente, ce qui est correct.
    </p>
    <p class="footnote">
        <sup>6</sup> Ce résultat peut être établi immédiatement à partir de l'accélération du mouvement.
    </p>

    <h4>1.5 Lagrangien et lois de conservation</h4>
    <p>
        Dans tout phénomène physique il existe des quantités conservées au cours de l'évolution. Ces quantités, aussi appelées en mécanique “<strong>intégrales premières du mouvement</strong>", jouent un rôle important en fournissant des renseignements sur la dynamique, même si la trajectoire n'est pas explicitement connue. Par exemple, on peut donner beaucoup de caractéristiques générales des collisions en écrivant la conservation de l'impulsion ou de l'énergie, sans même connaître de façon détaillée la loi régissant l'interaction entre les particules<sup>7</sup>.
    </p>
    <p>
        Parmi toutes les quantités conservées dans le mouvement, certaines sont triviales et d'autres sans interprétation physique directe. Certaines en revanche, comme l'<strong>énergie</strong> ou l'<strong>impulsion</strong>, sont directement reliées à des propriétés physiques très fondamentales. Comme nous le verrons, il existe en général une quantité conservée associée à chaque invariance du système dans une transformation (à chaque propriété de symétrie, au sens le plus large). Nous verrons par exemple que la conservation de l'impulsion découle directement de l'invariance par translation dans l'espace. C'est l'essence du <strong>théorème de Noether</strong>.
    </p>
    <p>
        Avant d'entrer dans le détail de ces lois de conservation, prouvons d'abord l'existence de quantités conservées dans une évolution lagrangienne. Nous considérerons dans tout ce paragraphe un système exempt des complications et généralisations introduites au paragraphe précédent. Nous ne considérerons donc que des liaisons holonomes. Comme les équations de Lagrange du système pour les \( n \) coordonnées généralisées \( q_i \) sont du second ordre en temps, la solution explicite du problème fait intervenir \( 2n \) constantes représentant les conditions aux limites (valeurs des coordonnées aux deux extrémités de la trajectoire, ou position et vitesse initiales). L'une de ces constantes peut toujours être mise sous la forme d'une origine arbitraire \( t_0 \) sur le temps. La solution la plus générale peut donc s'écrire sous la forme:
        $$ q_i(t + t_0, C_1, \ldots, C_{2n-1}), \quad \dot{q}_i(t + t_0, C_1, \ldots, C_{2n-1}), \quad (1.63) $$
        où \( t_0 \) et les \( C_k \) sont les 2n constantes d'intégration. Le mouvement étant déterminé, on peut inverser ces relations entre les 2n constantes et les coordonnées et vitesses à un instant \( t \), et écrire:
        $$ t_0(q_i, \dot{q}_i, t), \quad C_k(q_i, \dot{q}_i,t) . \quad (1.64) $$
    </p>
    <p>
        L'origine du temps joue un rôle particulier, et n'est pas à proprement parler une intégrale première du mouvement. En revanche, les \( 2n - 1 \) \( C_k \) sont bien des fonctions de l'état dynamique du système qui restent constantes au cours du mouvement. Il y a donc, de façon très générale, au moins \( 2n - 1 \) intégrales premières indépendantes dans un mouvement à \( n \) degrés de liberté.
    </p>
    <p>
        Dans la suite de ce paragraphe, nous allons nous concentrer sur trois d'entre elles: l'impulsion, l'énergie et le moment cinétique et montrer comment elles se déduisent de propriétés de symétrie du lagrangien.
    </p>
     <p class="footnote">
        <sup>7</sup> On consultera avec profit le Landau de Mécanique sur ce problème que nous n'aborderons pas du tout dans ce cours.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 36 -->
    <!-- ===================================================================== -->
    <h5>1.5.1 Invariance par translation dans le temps: énergie</h5>
    <p>
        Nous considérons ici un système isolé. La première conséquence est que la fonction de Lagrange \( L \) ne peut dépendre explicitement du temps. Il n'y a rien en effet dans l'environnement du système pour fixer une origine de temps (\( \partial L / \partial t = 0 \)). Nous supposerons de plus que les équations dynamiques de ce système sont des équations de Lagrange standard (sans forces généralisées \( Q'_i \) non conservatives ou fonction de dissipation \( \mathcal{F} \)). On exclut donc explicitement le cas où le système serait soumis à des forces de frottement (difficilement compatibles avec l'hypothèse d'un système isolé).
    </p>
    <p>
        On a donc \( \partial L / \partial t = 0 \). La dérivée totale de \( L \) par rapport au temps, somme de sa dérivée partielle (nulle) et des variations temporelles provenant de la variation des coordonnées généralisées, peut donc s'écrire:
        $$ \frac{dL}{dt} = \sum_i \left( \frac{\partial L}{\partial q_i} \dot{q}_i + \frac{\partial L}{\partial \dot{q}_i} \ddot{q}_i \right) \quad (1.65) $$
        En utilisant les équations de Lagrange \( \frac{\partial L}{\partial q_i} = \frac{d}{dt} \frac{\partial L}{\partial \dot{q}_i} \), on met cette dérivée sous la forme:
        $$ \frac{dL}{dt} = \sum_i \left( \left( \frac{d}{dt} \frac{\partial L}{\partial \dot{q}_i} \right) \dot{q}_i + \frac{\partial L}{\partial \dot{q}_i} \ddot{q}_i \right) = \sum_i \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_i} \dot{q}_i \right) \quad (1.66) $$
    </p>
    <p>
        On trouve ainsi que \( \frac{d}{dt} \left( \sum_i \frac{\partial L}{\partial \dot{q}_i} \dot{q}_i - L \right) = 0 \). La quantité:
        $$ E = \sum_i \frac{\partial L}{\partial \dot{q}_i} \dot{q}_i - L \quad (1.67) $$
        est une constante ou intégrale première du mouvement. Notons tout de suite qu'elle a la même dimension que \( L \), c'est à dire celle d'une énergie. Pour préciser son interprétation physique, considérons le cas où les forces internes au système dérivent d'une énergie potentielle \( U \) ne dépendant que des \( q_i \) (et pas des \( \dot{q}_i \) ni de \( t \)). On a alors \( L = T(q_i, \dot{q}_i) - U(q_i) \). \( T \) est très généralement une forme quadratique des dérivées temporelles des coordonnées généralisées<sup>8</sup>. \( T \) vérifie donc le théorème d'Euler pour les fonctions homogènes de degré 2:
        $$ \sum_i \frac{\partial T}{\partial \dot{q}_i} \dot{q}_i = 2T \quad (1.68) $$
    </p>
    <p>
        Comme \( U \) ne dépend que des \( \dot{q}_i \), \( \partial L / \partial \dot{q}_i = \partial T / \partial \dot{q}_i \), et donc
        $$ E = \sum_i \frac{\partial T}{\partial \dot{q}_i} \dot{q}_i - L = 2T - (T - U) = T + U . \quad (1.69) $$
        La quantité \( E \) coïncide donc dans ce cas simple avec l'<strong>énergie mécanique totale</strong> du système. Dans un cas plus complexe (par exemple avec un potentiel généralisé dépendant des vitesses comme pour la force EM), nous admettrons donc que l'énergie mécanique du système (ou plus précisément, la fonction de Hamilton) est définie comme \( E \) et est donc une intégrale première du mouvement si \( L \) ne dépend pas explicitement du temps. Cette loi de conservation apparaît ici très clairement comme une conséquence directe de l'invariance par translation dans le temps (homogénéité du temps).
    </p>
    <p>
        L'hypothèse du système isolé (\( \partial L/\partial t = 0 \)) exclut bien sûr de traiter le cas d'un ensemble de particules en interaction avec un champ électromagnétique extérieur dépendant du temps. Il existe cependant un cas où on peut définir une énergie mécanique conservée pour un tel système: celui d'un champ <strong>statique</strong>. Les équations de Lagrange s'écrivent en effet normalement avec le lagrangien
        $$ L = \sum_\alpha (T_\alpha - q_\alpha V_\alpha + q_\alpha \mathbf{A}_\alpha \cdot \mathbf{v}_\alpha), \quad (1.70) $$
        et les notations du paragraphe 1.3 (pour simplifier les écritures nous supposerons ici que les coordonnées généralisées sont les coordonnées cartésiennes). Si \( \mathbf{A} \) ne dépend que de la position des particules (\( \mathbf{A}_\alpha = \mathbf{A}(\mathbf{r}_\alpha) \)) et \( V \) aussi (\( V_\alpha = V(\mathbf{r}_\alpha) \)), alors \( L \) ne dépend pas explicitement du temps, donc \( \partial L/\partial t = 0 \).
    </p>
    <p class="footnote">
        <sup>8</sup> Seulement dans le cas où les contraintes ne font pas explicitement intervenir de dépendance temporelle.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 37 -->
    <!-- ===================================================================== -->
    <p>
        étant explicitement indépendant du temps, le raisonnement précédent s'applique en entier. L'énergie mécanique \( E = \sum \mathbf{p}_\alpha \cdot \mathbf{v}_\alpha - L \) s'écrit simplement dans ce cas:
        $$ E = \sum_\alpha \nabla_{\mathbf{v}_\alpha} L \cdot \mathbf{v}_\alpha - L \quad (1.71) $$
        Elle est conservée et on a:
        $$ \sum_\alpha \nabla_{\mathbf{v}_\alpha} L \cdot \mathbf{v}_\alpha = \sum_\alpha (m_\alpha \mathbf{v}_\alpha + q_\alpha \mathbf{A}_\alpha) \cdot \mathbf{v}_\alpha = \sum_\alpha m_\alpha v_\alpha^2 + \sum_\alpha q_\alpha \mathbf{A}_\alpha \cdot \mathbf{v}_\alpha = 2T + \sum_\alpha q_\alpha \mathbf{A}_\alpha \cdot \mathbf{v}_\alpha. \quad (1.72 \text{ adapté}) $$
        Et donc:
        $$ E = \left( 2T + \sum_\alpha q_\alpha \mathbf{A}_\alpha \cdot \mathbf{v}_\alpha \right) - \left( T - \sum_\alpha q_\alpha V_\alpha + \sum_\alpha q_\alpha \mathbf{A}_\alpha \cdot \mathbf{v}_\alpha \right) $$
        $$ E = T + \sum_\alpha q_\alpha V_\alpha, \quad (1.73) $$
        résultat évident de statique: l'énergie conservée est l'énergie cinétique plus l'énergie potentielle électrostatique.
    </p>

    <h5>1.5.2 Translation spatiale: conservation de l'impulsion</h5>
    <p>
        Nous considérons, comme dans le paragraphe précédent, un système isolé régi par des équations de Lagrange sous la forme standard. La dynamique est visiblement invariante si on déplace globalement le système. Il n'existe rien dans l'environnement pour fixer une origine des coordonnées (homogénéité de l'espace). Comme ce déplacement est une quantité vectorielle, on a en fait trois conditions d'invariance d'où on peut déduire la conservation de trois quantités (les composantes du vecteur impulsion totale).
    </p>
    <p>
        Nous allons d'abord supposer que le système est décrit par ses coordonnées cartésiennes \( \mathbf{r}_\alpha \). Les coordonnées généralisées posent en effet problème, puisqu'une translation spatiale n'a pas forcément une expression simple en termes de ces coordonnées. Nous examinerons ce cas à la fin du paragraphe. Nous considérons une translation d'ensemble infinitésimale \( \boldsymbol{\varepsilon} \) du système, qui s'écrit:
        $$ \mathbf{r}_\alpha \to \mathbf{r}'_\alpha = \mathbf{r}_\alpha + \boldsymbol{\varepsilon}. \quad (1.74) $$
    </p>
    <p>
        La translation \( \boldsymbol{\varepsilon} \) est supposée petite à l'échelle des longueurs caractéristiques du système. On peut aisément exprimer la variation de la fonction de Lagrange dans cette translation. Puisque les vitesses ne changent pas (\( \mathbf{v}'_\alpha = \mathbf{v}_\alpha \)), la variation de L vient uniquement de la dépendance éventuelle en \( \mathbf{r}_\alpha \):
        $$ \delta L = L(\mathbf{r}'_\alpha, \mathbf{v}_\alpha) - L(\mathbf{r}_\alpha, \mathbf{v}_\alpha) = \sum_\alpha (\nabla_{\mathbf{r}_\alpha} L) \cdot \delta \mathbf{r}_\alpha = \left( \sum_\alpha \nabla_{\mathbf{r}_\alpha} L \right) \cdot \boldsymbol{\varepsilon}. \quad (1.75) $$
    </p>
    <p>
        L'invariance par translation (\( \delta L = 0 \) pour tout \( \boldsymbol{\varepsilon} \)) ne peut être vraie que si
        $$ \sum_\alpha \nabla_{\mathbf{r}_\alpha} L = 0 . \quad (1.76) $$
        En utilisant les équations de Lagrange en coordonnées cartésiennes, \( \nabla_{\mathbf{r}_\alpha} L = \frac{d}{dt} (\nabla_{\mathbf{v}_\alpha} L) \), on met cette condition sous la forme:
        $$ \frac{d\mathbf{P}}{dt} = 0, \quad (1.77) $$
        avec l'impulsion totale (canonique)
        $$ \mathbf{P} = \sum_\alpha \mathbf{p}_\alpha = \sum_\alpha \nabla_{\mathbf{v}_\alpha} L . \quad (1.78) $$
    </p>
    <p>
        Nous trouvons donc bien une intégrale première vectorielle pour le mouvement. Dans le cas où \( L=T-U \), avec \( T = \sum \frac{1}{2} m_\alpha v_\alpha^2 \) et \( U \) ne dépendant que des \( \mathbf{r}_\alpha \), \( \nabla_{\mathbf{v}_\alpha} L = \nabla_{\mathbf{v}_\alpha} T = m_\alpha \mathbf{v}_\alpha \) et
        $$ \mathbf{P} = \sum_\alpha m_\alpha \mathbf{v}_\alpha, \quad (1.79) $$
        indiquant que cette intégrale première vectorielle n'est autre que l'impulsion ou quantité de mouvement totale habituelle.
    </p>

     <!-- ===================================================================== -->
    <!-- Page 38 -->
    <!-- ===================================================================== -->
     <p>
        Notons à ce point que l'impulsion (canonique) totale \( \mathbf{P} = \sum \nabla_{\mathbf{v}_\alpha} L \) ne coïncide pas forcément avec l'expression habituelle \( \sum m_\alpha \mathbf{v}_\alpha \). Ce sera en particulier le cas en électromagnétisme où \( \mathbf{p}_\alpha = m_\alpha \mathbf{v}_\alpha + q_\alpha \mathbf{A}_\alpha \). Comme seuls des potentiels vecteur et scalaire uniformes (c'est à dire des champs nuls) seraient compatibles avec les hypothèses actuelles (système isolé, \( \sum \nabla_{\mathbf{r}_\alpha} L = 0 \)), nous n'examinerons pas ce cas pour l'instant.
    </p>
    <p>
        Etudions maintenant le cas où l'existence de contraintes impose le recours à des coordonnées généralisées \( q_i \). L'invariance de l'impulsion totale ne devrait pas dépendre de l'existence de contraintes internes au système. Toutefois, la conservation de \( \mathbf{P} \) ne peut plus être établie aussi simplement, puisqu'une translation \( \boldsymbol{\varepsilon} \) n'a pas nécessairement une expression simple en termes de coordonnées généralisées. Définissons quand même, par analogie avec le cas précédent, une "<strong>impulsion généralisée</strong>" \( p_i \) associée à la coordonnée généralisée \( q_i \) par
        $$ p_i = \frac{\partial L}{\partial \dot{q}_i} \quad (1.80) $$
        Nous verrons que des impulsions généralisées jouent un rôle central dans le formalisme hamiltonien. En attendant, notons que l'énergie mécanique totale (1.67) peut se réécrire simplement:
        $$ E = \sum_i p_i \dot{q}_i - L . \quad (1.81) $$
    </p>
    <p>
        Supposons maintenant que la fonction de Lagrange \( L \) ne fasse pas explicitement intervenir la coordonnée \( q_i \):
        $$ \frac{\partial L}{\partial q_i} = 0 . \quad (1.82) $$
        Nous dirons alors que \( q_i \) est une coordonnée "<strong>cyclique</strong>" ou "ignorable". La simple écriture de l'équation de Lagrange pour \( q_i \) donne alors:
        $$ \frac{dp_i}{dt} = \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_i} \right) = \frac{\partial L}{\partial q_i} = 0 . \quad (1.83) $$
        L'impulsion généralisée \( p_i \) associée à une coordonnée cyclique est conservée.
    </p>
    <p>
        Revenons maintenant à l'invariance par translation. Pour un système isolé, on peut toujours choisir comme trois des coordonnées généralisées les trois coordonnées cartésiennes \( \mathbf{R} = (X, Y, Z) \) du centre d'inertie. Les autres coordonnées décrivent la configuration interne du système. Pour un système isolé, le Lagrangien ne peut pas dépendre de la position globale du système, donc \( \partial L / \partial X = \partial L / \partial Y = \partial L / \partial Z = 0 \). Les coordonnées du centre d'inertie sont cycliques. Il en résulte que les trois impulsions associées \( P_X = \partial L / \partial \dot{X} \), \( P_Y = \partial L / \partial \dot{Y} \), \( P_Z = \partial L / \partial \dot{Z} \) sont des intégrales premières du mouvement, formant un vecteur \( \mathbf{P} \) qui n'est autre que l'impulsion totale (1.78) ou (1.79).
    </p>

    <h5>1.5.3 Invariance par rotation: moment cinétique</h5>
    <p>
        Nous appliquerons ici une méthode très semblable à celle du paragraphe précédent au cas où le système et donc sa fonction de Lagrange sont invariants dans une rotation quelconque autour d'un axe défini par un vecteur unitaire \( \mathbf{u} \). C'est en particulier le cas pour un système isolé (isotropie de l'espace). Nous examinerons ici uniquement le cas où le système est défini par les coordonnées cartésiennes des particules.
    </p>
    <p>
        Nous considérons une rotation infinitésimale d'un angle \( \delta \phi \) autour de l'axe \( \mathbf{u} \). En posant \( \delta \boldsymbol{\phi} = \delta \phi \mathbf{u} \), nous pouvons écrire les variations des positions et vitesses dans cette transformation \( \delta \mathbf{r}_\alpha = \delta \boldsymbol{\phi} \times \mathbf{r}_\alpha \) et \( \delta \mathbf{v}_\alpha = \delta \boldsymbol{\phi} \times \mathbf{v}_\alpha \). L'invariance par rotation impose que la variation \( \delta L \) de la fonction de Lagrange soit nulle dans cette transformation. Or
        $$ \delta L = \sum_\alpha (\nabla_{\mathbf{r}_\alpha} L \cdot \delta \mathbf{r}_\alpha + \nabla_{\mathbf{v}_\alpha} L \cdot \delta \mathbf{v}_\alpha) . \quad (1.84) $$
        En utilisant les équations de Lagrange, qui s'écrivent \( \nabla_{\mathbf{r}_\alpha} L = \dot{\mathbf{p}}_\alpha \), où \( \mathbf{p}_\alpha = \nabla_{\mathbf{v}_\alpha} L \) est l'impulsion (canonique) de la particule \( \alpha \), on peut écrire:
        $$ \delta L = \sum_\alpha [\dot{\mathbf{p}}_\alpha \cdot (\delta \boldsymbol{\phi} \times \mathbf{r}_\alpha) + \mathbf{p}_\alpha \cdot (\delta \boldsymbol{\phi} \times \mathbf{v}_\alpha)] $$
        En utilisant l'identité du produit mixte \( \mathbf{a} \cdot (\mathbf{b} \times \mathbf{c}) = \mathbf{b} \cdot (\mathbf{c} \times \mathbf{a}) = \mathbf{c} \cdot (\mathbf{a} \times \mathbf{b}) \):
        $$ \delta L = \sum_\alpha [\delta \boldsymbol{\phi} \cdot (\mathbf{r}_\alpha \times \dot{\mathbf{p}}_\alpha) + \delta \boldsymbol{\phi} \cdot (\mathbf{v}_\alpha \times \mathbf{p}_\alpha)] $$
        $$ \delta L = \delta \boldsymbol{\phi} \cdot \sum_\alpha [\mathbf{r}_\alpha \times \dot{\mathbf{p}}_\alpha + \dot{\mathbf{r}}_\alpha \times \mathbf{p}_\alpha] = \delta \boldsymbol{\phi} \cdot \sum_\alpha \frac{d}{dt} (\mathbf{r}_\alpha \times \mathbf{p}_\alpha) $$
        $$ \delta L = \delta \boldsymbol{\phi} \cdot \frac{d\mathbf{L}}{dt}, \quad (1.85) $$
        où nous avons posé le <strong>moment cinétique total</strong> (canonique):
        $$ \mathbf{L} = \sum_\alpha \mathbf{r}_\alpha \times \mathbf{p}_\alpha \quad (1.86) $$
    </p>

     <!-- ===================================================================== -->
    <!-- Page 39 -->
    <!-- ===================================================================== -->
    <p>
        L'invariance de la fonction de Lagrange (\( \delta L = 0 \)) pour une rotation arbitraire \( \delta \boldsymbol{\phi} \) autour de l'axe \( \mathbf{u} \) implique que la composante \( dL_u/dt = \frac{d\mathbf{L}}{dt} \cdot \mathbf{u} \) soit nulle. La composante du vecteur \( \mathbf{L} \) sur l'axe de rotation est une intégrale première du mouvement. Nous retrouvons ainsi la conservation du moment cinétique par rapport à un axe.
    </p>
    <p>
        On peut voir aussi, plus simplement, dans ce cas, que le lagrangien est indépendant d'une coordonnée généralisée \( \phi \) décrivant l'angle de rotation autour de l'axe \( \mathbf{u} \). Il est donc cyclique dans cette coordonnée. L'impulsion généralisée \( p_\phi = \partial L / \partial \dot{\phi} \) associée à cette coordonnée est constante. Il est facile de vérifier qu'il s'agit bien de la composante le long de cet axe du moment cinétique \( L_u \).
    </p>
    <p>
        Dans le cas où le système est invariant dans une rotation arbitraire autour d'un axe quelconque (système isolé, isotropie de l'espace), il en résulte que le moment cinétique total \( \mathbf{L} \) est une constante vectorielle du mouvement.
    </p>

    <h4>1.6 Action en fonction de la trajectoire</h4>
    <p>
        Nous allons utiliser les définitions du paragraphe précédent pour tenter d'exprimer simplement la dépendance de l'action \( S \) calculée sur la trajectoire effectivement suivie en fonction des coordonnées spatiales et temporelles du point de départ (\( q(1), t_1 \)) et du point d'arrivée (\( q(2), t_2 \)). En d'autres termes, l'objet de ce paragraphe est de donner les dérivées partielles de \( S(q(1), t_1, q(2), t_2) \), action sur la trajectoire suivie considérée comme une fonction des conditions aux limites. Ces résultats nous seront fort utiles dans la suite du cours (notamment en lien avec l'équation de Hamilton-Jacobi). Ils nous permettront aussi de jeter un regard nouveau sur les lois de conservation associées aux invariances.
    </p>

    <h5>1.6.1 Dépendance en position</h5>
    <p>
        Nous considérons ici la variation de \( S \) en fonction de la position du point d'arrivée \( q(2) \). Nous en déduirons immédiatement la dépendance vis à vis du point de départ \( q(1) \). Nous considérons donc ici deux trajectoires <i>effectivement suivies</i> (c'est-à-dire solutions des équations de Lagrange) entre les instants \( t_1 \) et \( t_2 \). La première (trajectoire de référence) s'effectue entre les valeurs \( q_i(1) \) et \( q_i(2) \) des coordonnées généralisées. La seconde entre les valeurs \( q_i(1) \) et \( q_i(2) + \delta q_i(2) \), où \( \delta q_i(2) \) est un accroissement infinitésimal de la position du point d'arrivée. Les trajectoires, par continuité, restent infiniment voisines pour tous les instants<sup>9</sup> et on écrira \( \delta q_i(t) \) l'écart entre elles (\( \delta q_i(t_1)=0, \delta q_i(t_2)=\delta q_i(2) \)).
        La variation de l'action en passant d'une trajectoire à l'autre, \( \delta S \), s'écrit simplement:
        $$ \delta S = \int_{t_1}^{t_2} \delta L dt, \quad (1.87) $$
        où \( \delta L \) est la variation de la fonction de Lagrange entre les deux points à l'instant \( t \). On suit alors un raisonnement identique à celui utilisé pour établir les équations de Lagrange. On écrit d'abord:
        $$ \delta L = \sum_i \left( \frac{\partial L}{\partial q_i} \delta q_i + \frac{\partial L}{\partial \dot{q}_i} \delta \dot{q}_i \right), \quad (1.88) $$
    </p>
     <p class="footnote">
        <sup>9</sup> Si la dynamique du système était chaotique, deux trajectoires très voisines aux points de départ et d'arrivée, peuvent s'écarter notablement l'une de l'autre. Comme nous manipulons des accroissements infinitésimaux, ce problème ne se pose pas.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 40 -->
    <!-- ===================================================================== -->
    <p>
        et on reporte cette expression dans celle de \( \delta S \). Le terme faisant intervenir \( \delta \dot{q}_i = d(\delta q_i)/dt \) est alors intégré par parties. On obtient:
        $$ \delta S = \int_{t_1}^{t_2} \sum_i \left( \frac{\partial L}{\partial q_i} - \frac{d}{dt} \frac{\partial L}{\partial \dot{q}_i} \right) \delta q_i dt + \left[ \sum_i \frac{\partial L}{\partial \dot{q}_i} \delta q_i \right]_{t_1}^{t_2} \quad (1.89) $$
    </p>
    <p>
        La trajectoire de référence que nous considérons ici est une solution des équations du mouvement. Les équations de Lagrange \( (\frac{\partial L}{\partial q_i} - \frac{d}{dt} \frac{\partial L}{\partial \dot{q}_i} = 0) \) étant constamment vérifiées, l'intégrale dans l'expression ci-dessus s'annule identiquement. Il ne reste donc que le terme tout intégré, qui se réduit à (puisque \( \delta q_i(t_1)=0 \) et \( \delta q_i(t_2) = \delta q_i(2) \)):
        $$ \delta S = \sum_i \frac{\partial L}{\partial \dot{q}_i}(t_2) \delta q_i(2) . \quad (1.90) $$
    </p>
    <p>
        De manière évidente, si nous avions considéré deux trajectoires différant d'une quantité infinitésimale \( \delta q_i(1) \) au point de départ ( \( \delta q_i(t_2)=0 \) ), nous aurions obtenu:
        $$ \delta S = - \sum_i \frac{\partial L}{\partial \dot{q}_i}(t_1) \delta q_i(1) . \quad (1.91) $$
    </p>
    <p>
        Ces deux expressions nous donnent les dérivées partielles de l'action \( S(q(1), t_1, q(2), t_2) \), considérée comme une fonction des coordonnées des points de départ et d'arrivée. En remarquant que \( \partial L / \partial \dot{q}_i = p_i \) (impulsion généralisée), on écrira
        $$ \frac{\partial S}{\partial q_i(2)} = p_i(2) \quad (1.92) $$
        $$ \frac{\partial S}{\partial q_i(1)} = -p_i(1) \quad (1.93) $$
    </p>
    <p>
        On peut facilement retrouver, à partir de ce résultat, l'invariance de l'impulsion associée à une coordonnée cyclique. Si \( q_i \) est cyclique, la fonction de Lagrange ne dépend pas de \( q_i \) et le mouvement (et donc l'action S) doit être invariant dans une translation de la coordonnée \( q_i \). Considérons donc la translation infinitésimale \( q_i \to q_i + \epsilon \) affectant à la fois le point de départ et le point d'arrivée \( \delta q_i(1) = \delta q_i(2) = \epsilon \). La variation de l'action dans cette transformation est:
        $$ \delta S = \sum_j \left( \frac{\partial S}{\partial q_j(1)} \delta q_j(1) + \frac{\partial S}{\partial q_j(2)} \delta q_j(2) \right) = \frac{\partial S}{\partial q_i(1)} \epsilon + \frac{\partial S}{\partial q_i(2)} \epsilon = (-p_i(1) + p_i(2))\epsilon, \quad (1.94) $$
        L'invariance \( \delta S = 0 \) implique \( p_i(1) = p_i(2) \), d'où on tire immédiatement la conservation de \( p_i \). Dans le cas où les coordonnées cycliques sont celles du centre d'inertie, on retrouve la conservation de l'impulsion au sens habituel.
    </p>

    <h5>1.6.2 Dépendance en temps</h5>
    <p>
        Nous considérons maintenant la dépendance de l'action dans le temps d'arrivée \( t_2 \). Nous considérons donc deux trajectoires effectivement suivies par le système. L'une, entre \( (q(1),t_1) \) et \( (q(2), t_2) \) est la trajectoire de référence. L'autre coïncide avec la première jusqu'à l'instant \( t_2 \) et continue ensuite pendant un intervalle de temps infinitésimal \( \delta t_2 \) jusqu'à \( t'_2 = t_2 + \delta t_2 \), les coordonnées étant alors \( q_i(t'_2) = q_i(2) + \delta q_i(2) \).
        On peut écrire de manière évidente la variation de l'action entre ces deux trajectoires comme l'action accumulée pendant l'intervalle \( \delta t_2 \):
        $$ \delta S = S' - S = \int_{t_1}^{t_2+\delta t_2} L dt - \int_{t_1}^{t_2} L dt = \int_{t_2}^{t_2+\delta t_2} L dt \approx L(t_2)\delta t_2, \quad (1.95) $$
        mais aussi comme (variation totale de S vue comme fonction de ses arguments \( q(2) \) et \( t_2 \)):
        $$ \delta S = \frac{\partial S}{\partial t_2} \delta t_2 + \sum_i \frac{\partial S}{\partial q_i(2)} \delta q_i(2) . \quad (1.96) $$
    </p>
    <p>
        En effet l'instant du point d'arrivée et ses coordonnées varient. En utilisant les résultats du paragraphe précédent (\( \partial S / \partial q_i(2) = p_i(2) \)) et en remarquant que la variation des coordonnées au bout du temps supplémentaire est \( \delta q_i(2) \approx \dot{q}_i(2)\delta t_2 \), on peut écrire:
        $$ L(t_2) \delta t_2 = \frac{\partial S}{\partial t_2} \delta t_2 + \sum_i p_i(2) \dot{q}_i(2) \delta t_2 . \quad (1.97) $$
    </p>

     <!-- ===================================================================== -->
    <!-- Page 41 -->
    <!-- ===================================================================== -->
    <p>
        En nous souvenant de la définition de l'énergie mécanique totale \( E = \sum p_i \dot{q}_i - L \)<sup>10</sup>, nous avons enfin:
        $$ \frac{\partial S}{\partial t_2} = L(t_2) - \sum_i p_i(2)\dot{q}_i(2) = -E(2) . \quad (1.98) $$
    </p>
     <p class="footnote">
        <sup>10</sup> Nous n'avons fait dans ce paragraphe aucune hypothèse sur la dépendance en temps de la fonction de Lagrange. \( E \) n'est donc pas nécessairement une quantité conservée. En fait, plutôt que d'énergie totale, nous devrions parler de fonction de Hamilton (voir chapitre suivant).
    </p>
    <p>
        En reproduisant le même raisonnement pour une variation de l'instant de départ, on obtiendrait de même:
        $$ \frac{\partial S}{\partial t_1} = E(1) . \quad (1.99) $$
    </p>
    <p>
        Avec ces deux expressions et les résultats (1.92, 1.93) du paragraphe précédent, nous connaissons toutes les dérivées partielles de l'action \( S(q(1), t_1, q(2), t_2) \) en fonction des conditions aux limites imposées à la trajectoire.
    </p>
    <p>
        Notons également qu'on peut retrouver facilement à partir de ces expressions la conservation de l'énergie mécanique. Si la fonction de Lagrange ne dépend pas explicitement du temps, l'action doit être invariante dans une translation temporelle globale infinitésimale \( t \to t + \delta t \), c'est-à-dire \( t_1 \to t_1 + \delta t, t_2 \to t_2 + \delta t \). La variation de l'action dans cette translation s'écrivant évidemment \( \delta S = \frac{\partial S}{\partial t_1} \delta t + \frac{\partial S}{\partial t_2} \delta t = (E(1) - E(2))\delta t \), l'invariance \( \delta S = 0 \) implique \( E(1) = E(2) \), on retrouve l'invariance de l'énergie mécanique.
    </p>

    <h4>1.7 Deux théorèmes utiles</h4>
    <p>
        Nous considérerons dans ce paragraphe le cas particulier important des énergies potentielles <strong>homogènes</strong>, c'est à dire telles que pour une mise à l'échelle \( \alpha \) des coordonnées:
        $$ U(\alpha q_1, \ldots, \alpha q_n) = \alpha^k U(q_1, \ldots, q_n). \quad (1.100) $$
        \( k \) est le degré d'homogénéité. Ce cas, très spécifique, se rencontre en fait dans une grande variété de problèmes de mécanique:
    </p>
    <ul>
        <li>Pour l'oscillateur harmonique unidimensionnel \( U = Kx^2/2 \) est évidemment une fonction homogène avec \( k = 2 \). Ce résultat est bien sûr valide aussi pour les oscillateurs multidimensionnels.</li>
        <li>Le potentiel gravitationnel ou Coulombien en \( 1/r \) correspond à \( k = -1 \).</li>
        <li>Le mouvement dans un champ uniforme (par exemple champ de pesanteur local, \( U=mgz \)) correspond enfin à \( k = 1 \).</li>
    </ul>
    <p>
        Le fait que \( U \) soit une fonction homogène a deux conséquences importantes que nous allons examiner dans les prochains paragraphes. D'abord, on peut en déduire des <strong>lois d'échelle</strong> utiles fixant la dépendance relative de certains paramètres des trajectoires (par exemple la troisième loi de Kepler). La deuxième conséquence est le <strong>théorème du viriel</strong>, d'une grande importance en mécanique et physique statistique.
    </p>

    <h5>1.7.1 Lois d'échelle</h5>
    <p>
        Considérons une transformation d'échelle sur les coordonnées généralisées et le temps. Elle peut s'écrire:
        $$ q_i \to q'_i = \alpha q_i \quad (1.101) $$
        $$ t \to t' = \beta t \quad (1.102) $$
    </p>

    <!-- ===================================================================== -->
    <!-- Page 42 -->
    <!-- ===================================================================== -->
    <p>
        On en déduit les transformations de quelques quantités:
        $$ \dot{q}_i \to \dot{q}'_i = \frac{\alpha}{\beta} \dot{q}_i \quad (1.103) $$
        $$ U \to U' = \alpha^k U \quad (1.104) $$
        $$ T \to T' = \left(\frac{\alpha}{\beta}\right)^2 T \quad (1.105) $$
    </p>
    <p>
        Pour établir la dernière ligne, il faut admettre que l'énergie cinétique \( T \) est une fonction quadratique homogène des \( \dot{q}_i \) et ne dépend pas des \( q_i \). C'est en particulier le cas en coordonnées cartésiennes standard. Nous supposerons cette condition remplie dans toute la suite du paragraphe.
    </p>
    <p>
        En général, le lagrangien \( L=T-U \) ne se transforme pas de manière simple. En revanche, dans le cas particulier où les facteurs d'échelle sur \( T \) et \( U \) sont les mêmes, c'est à dire si on choisit les facteurs d'échelle \( \alpha \) et \( \beta \) de telle manière que:
        $$ \left(\frac{\alpha}{\beta}\right)^2 = \alpha^k, \quad (1.106) $$
        où encore
        $$ \beta = \alpha^{1-k/2}, \quad (1.107) $$
        alors \( L' = T' - U' = \alpha^k T - \alpha^k U = \alpha^k L \). La fonction de Lagrange est simplement multipliée par un facteur d'échelle constant \( \alpha^k \). Un tel facteur est sans effet sur les équations du mouvement. À une trajectoire possible \( q_i(t) \) correspond donc après cette transformation d'espace (\( \alpha \)) et de temps (\( \beta \)) une autre trajectoire possible \( q'_i(t') = \alpha q_i(t'/ \beta) \). Cette correspondance permet par exemple d'obtenir les lois reliant la période d'un mouvement à l'extension spatiale de la trajectoire. Appliquons ces arguments aux cas particulièrement importants de l'oscillateur harmonique et du mouvement gravitationnel.
    </p>
    <ul>
        <li>Pour l'oscillateur harmonique, \( k = 2 \). L'équation (1.107) est donc satisfaite pour n'importe quelle valeur de \( \alpha \) à condition que \( \beta = \alpha^{1-2/2} = \alpha^0 = 1 \). On obtient donc une trajectoire possible en multipliant la coordonnée spatiale par un facteur arbitraire \( \alpha \) et en laissant inchangée l'échelle de temps (\( \beta=1 \)). On retrouve ainsi très simplement l'<strong>isochronisme</strong> des oscillations de l'oscillateur harmonique : la période ne dépend pas de l'amplitude.</li>
        <li>Pour le mouvement dans un champ gravitationnel uniforme (pendule simple, chute libre), on a \( k = 1 \). L'équation (1.107) est donc satisfaite si \( \beta = \alpha^{1-1/2} = \alpha^{1/2} = \sqrt{\alpha} \). Deux trajectoires se correspondent donc si leurs extensions spatiales \( l \) et \( l' = \alpha l \) et temporelles (périodes) \( T \) et \( T' = \beta T \) sont reliées par \( T'/T = \beta = \sqrt{\alpha} = \sqrt{l'/l} \). On retrouve ainsi, par exemple, la dépendance en \( \sqrt{l} \) de la période des oscillations d'un pendule simple de longueur \( l \).</li>
        <li>Enfin, pour le cas du mouvement de Kepler dans un potentiel gravitationnel central (\( U \propto 1/r \)), on a \( k = -1 \). La relation (1.107) est donc satisfaite si \( \beta = \alpha^{1-(-1/2)} = \alpha^{3/2} \). On en déduit alors, par exemple, la troisième loi de Kepler qui relie la période d'une orbite \( T \) à son demi grand axe \( a \) (qui mesure son extension spatiale): \( T' = \beta T = \alpha^{3/2} T \). Comme \( a' = \alpha a \), on a \( \alpha = a'/a \), donc \( T' = (a'/a)^{3/2} T \), ce qui signifie \( T'^2/a'^3 = T^2/a^3 \). Le rapport \( T^2/a^3 \) est une constante.</li>
    </ul>
    <p>
        Ces trois exemples illustrent bien la puissance de ces simples lois d'échelle. En fait, ce genre d'arguments se transpose à des domaines très variés et permet souvent d'obtenir des lois très générales par de simples considérations d'échelle ou de dimensionnalité.
    </p>

    <h5>1.7.2 Théorème du Viriel</h5>
    <p>
        Nous établirons ici, dans le cas des énergies potentielles homogènes, un lien utile entre les énergies potentielles et cinétiques moyennes (moyennées sur un temps long devant les temps caractéristiques du mouvement, la période par exemple). Ce théorème possède de nombreuses applications en mécanique céleste et en physique statistique.
    </p>
    <p>
        L'énergie cinétique \( T \) est une forme quadratique des vitesses (si les contraintes sont indépendantes du temps et T ne dépend pas de q). On peut donc lui appliquer le théorème d'Euler pour les fonctions homogènes de degré 2:
        $$ 2T = \sum_i \frac{\partial T}{\partial \dot{q}_i} \dot{q}_i. \quad (1.108) $$
    </p>

    <!-- ===================================================================== -->
    <!-- Page 43 -->
    <!-- ===================================================================== -->
    <p>
        L'énergie potentielle \( U \) ne dépendant pas des vitesses généralisées \( \dot{q}_i \), on a \( \partial T/\partial \dot{q}_i = \partial L/\partial \dot{q}_i = p_i \). En utilisant la définition des impulsions généralisées, on peut mettre cette dernière relation sous la forme:
        $$ 2T = \sum_i p_i \dot{q}_i $$
        Considérons la dérivée temporelle de la quantité \( G = \sum_i p_i q_i \):
        $$ \frac{dG}{dt} = \sum_i (\dot{p}_i q_i + p_i \dot{q}_i) $$
        Donc \( 2T = \sum_i p_i \dot{q}_i = \frac{dG}{dt} - \sum_i \dot{p}_i q_i \). (1.109)
    </p>
    <p>
        Prenons maintenant la valeur moyenne temporelle de \( T \) définie comme:
        $$ \langle T \rangle = \lim_{\tau\to\infty} \frac{1}{\tau} \int_0^\tau T dt \quad (1.110) $$
        Notons que, dans le cas des mouvements périodiques de période \( \mathcal{T} \), on peut définir la moyenne temporelle comme l'intégrale sur une période: \( \langle T \rangle = \frac{1}{\mathcal{T}} \int_0^\mathcal{T} T dt \). En incluant dans cette définition de la valeur moyenne l'expression précédente de \( 2T \), on trouve:
        $$ 2\langle T \rangle = \lim_{\tau\to\infty} \frac{1}{\tau} \int_0^\tau \left( \frac{dG}{dt} - \sum_i \dot{p}_i q_i \right) dt = \lim_{\tau\to\infty} \frac{G(\tau) - G(0)}{\tau} - \left\langle \sum_i \dot{p}_i q_i \right\rangle \quad (1.111) $$
    </p>
    <p>
        Si le mouvement est <strong>borné</strong> (les \( q_i \) et \( p_i \) restent finis), alors \( G = \sum p_i q_i \) est borné. Le terme \( (G(\tau) - G(0)) / \tau \) tend vers zéro quand \( \tau \to \infty \). (Il est strictement nul si le mouvement est périodique et si les intégrales s'étendent sur exactement une période). On a donc:
        $$ 2\langle T \rangle = - \left\langle \sum_i \dot{p}_i q_i \right\rangle, \quad (1.112) $$
        ou encore, en utilisant les équations de Lagrange \( \dot{p}_i = \partial L / \partial q_i \):
        $$ 2\langle T \rangle = - \left\langle \sum_i \frac{\partial L}{\partial q_i} q_i \right\rangle . \quad (1.113) $$
    </p>
    <p>
        Si, comme dans le paragraphe précédent, \( T \) ne dépend que des \( \dot{q}_i \), on a \( \partial L/\partial q_i = -\partial U/\partial q_i \). Si enfin \( U \) est une fonction homogène des coordonnées de degré \( k \), on peut utiliser le théorème d'Euler \( \sum_i q_i \frac{\partial U}{\partial q_i} = k U \). On peut écrire:
        $$ 2\langle T \rangle = \left\langle \sum_i \frac{\partial U}{\partial q_i} q_i \right\rangle = \langle k U \rangle = k \langle U \rangle . \quad (1.114) $$
        C'est le <strong>théorème du viriel</strong>.
    </p>
    <p>Rappelons pour finir les hypothèses nécessaires à l'établissement de cette propriété:</p>
    <ul>
        <li>Les forces dérivent d'une énergie potentielle \( U(q_i) \) et les équations de Lagrange s'appliquent sous la forme ordinaire (\( L=T-U \)).</li>
        <li>L'énergie potentielle est une fonction des coordonnées homogène et de degré \( k \).</li>
        <li>L'énergie cinétique \( T(\dot{q}_i) \) ne dépend que des vitesses généralisées (quadratique homogène de degré 2).</li>
        <li>Le mouvement est borné dans l'espace des phases.</li>
    </ul>
    <p>
        Ces hypothèses contraignantes sont en fait assez souvent remplies. C'est par exemple le cas pour les mouvements périodiques bornés dans un potentiel gravitationnel central (\( k = -1 \)), où la relation s'écrit:
        $$ 2\langle T \rangle = -\langle U \rangle \quad (1.115) $$
        L'énergie totale moyenne est \( \langle E \rangle = \langle T \rangle + \langle U \rangle = \langle T \rangle - 2\langle T \rangle = -\langle T \rangle = \frac{1}{2} \langle U \rangle \).
    </p>
    <p>
        ou pour les mouvements dans un potentiel harmonique (nécessairement bornés) pour lesquels \( k = 2 \) et
        $$ 2\langle T \rangle = 2\langle U \rangle \Rightarrow \langle T \rangle = \langle U \rangle. \quad (1.116) $$
        L'énergie cinétique moyenne est égale à l'énergie potentielle moyenne.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 44 -->
    <!-- ===================================================================== -->
    <!-- Page vide -->


    <!-- ===================================================================== -->
    <!-- Page 45 -->
    <!-- ===================================================================== -->
    <h2>Chapitre 2</h2>
    <h3>Formulation hamiltonienne</h3>

    <p>
        Nous présenterons brièvement dans ce chapitre la formulation hamiltonienne de la mécanique. Bien qu'elle soit strictement équivalente à la formulation lagrangienne, elle s'avère souvent plus puissante et d'un usage plus commode.
    </p>
    <p>
        D'abord, d'un point de vue très utilitaire, la formulation hamiltonienne facilite la résolution, analytique ou numérique, des équations du mouvement. Les équations de Lagrange sont des équations différentielles du second ordre. Leur résolution analytique n'est pas toujours facile, si elle est possible. Très souvent (par exemple dès le problème à trois corps en mécanique céleste), on doit recourir à une intégration numérique. Il se trouve que les équations différentielles du second ordre ne se prêtent pas très bien à une telle intégration. Il se pose en particulier des problèmes sévères de stabilité numérique. En revanche, les équation différentielles du premier ordre s'intègrent très aisément et de façon numériquement stable. Comme nous le verrons, les équations de Hamilton sont du premier ordre.
    </p>
    <p>
        En fait, le formalisme hamiltonien consiste à traiter sur un même plan les positions \( q_i \) et les impulsions généralisées associées \( p_i \). Outre la transformation d'une équation de Lagrange du second ordre, portant sur la position seule, en deux équations de Hamilton du premier ordre reliant position et impulsion, cette approche ouvre la voie à des changements de variables (nous dirons des <strong>transformations canoniques</strong>) très puissants. Plutôt que de changer simplement de coordonnées généralisées, on peut en effet mélanger positions et impulsions dans un changement de variables. Il est même possible ainsi d'échanger le rôle des impulsions et des positions ou de prendre les conditions aux limites comme nouvelles variables. Cette immense liberté dans le choix de la description du problème est au centre de nombreuses méthodes de résolution des problèmes de mécanique.
    </p>
    <p>
        Un autre avantage décisif de la formulation hamiltonienne est qu'elle se prête à merveille à des méthodes de <strong>perturbations</strong> (développement de la solution en puissance des perturbations, supposées petites, par rapport à un problème dont la solution est connue). Ces méthodes sont d'une importance primordiale en mécanique céleste (prise en compte, par exemple, des perturbations au mouvement de Kepler dues aux autres planètes).
    </p>
    <p>
        Enfin, et surtout, c'est la formulation hamiltonienne de la mécanique classique qui se prête à la <strong>quantification</strong> (dite, elle aussi, canonique). Nous n'aborderons pas ce problème, mais un certain nombre des notions que nous introduirons dans ce chapitre parfaitement classique ont une contrepartie dans le formalisme quantique. Si, de manière évidente, la fonction de Hamilton est remplacée par l'opérateur hamiltonien, les crochets de Poisson, par exemple, correspondent aux commutateurs.
    </p>

    <h4>2.1 Equations de Hamilton</h4>
    <p>
        Nous partons de la formulation lagrangienne établie au chapitre précédent, dans sa forme la plus simple. Nous n'intégrerons donc pas les généralisations aux forces ne dérivant pas d'un potentiel (mises à part les forces électromagnétiques) ni les généralisations à des liaisons non holonomes. On
    </p>

    <!-- ===================================================================== -->
    <!-- Page 46 -->
    <!-- ===================================================================== -->
    <p>
        définit les impulsions généralisées \( p_i \) à partir de la fonction de Lagrange \( L(q_i, \dot{q}_i, t) \) des positions, des vitesses et du temps<sup>1</sup> par
        $$ p_i = \frac{\partial L}{\partial \dot{q}_i} \quad (2.1) $$
        et on peut écrire les équations de Lagrange sous la forme:
        $$ \dot{p}_i = \frac{\partial L}{\partial q_i} \quad (2.2) $$
    </p>
    <p>
        Ces écritures font apparaître \( L \) comme une fonction naturelle des \( q_i \) et des \( \dot{q}_i \), dont les dérivées partielles respectives sont les \( \dot{p}_i \) et les \( p_i \). La “différentielle totale" du lagrangien s'écrit alors:
        $$ dL = \sum_i \left( \frac{\partial L}{\partial q_i} dq_i + \frac{\partial L}{\partial \dot{q}_i} d\dot{q}_i \right) + \frac{\partial L}{\partial t} dt = \sum_i (\dot{p}_i dq_i + p_i d\dot{q}_i) + \frac{\partial L}{\partial t} dt \quad (2.3) $$
    </p>
    <p>
        La technique des <strong>transformations de Legendre</strong>, largement illustrée en thermodynamique classique<sup>2</sup>, permet de passer de \( L(q, \dot{q}, t) \) à une fonction dont la différentielle s'exprime de façon naturelle en fonction des \( q_i \) et des \( p_i \) (au lieu de \( q_i, \dot{q}_i \)). Posons en effet la <strong>fonction de Hamilton</strong> ou <strong>Hamiltonien</strong>:
        $$ H(q_i, p_i, t) = \sum_i p_i \dot{q}_i - L(q_i, \dot{q}_i, t) . \quad (2.4) $$
        Il faut comprendre que pour obtenir \( H \) comme fonction de \( q, p, t \), on doit inverser la relation (2.1) \( p_i = \partial L / \partial \dot{q}_i \) pour exprimer les vitesses \( \dot{q}_i \) en fonction des \( q_j, p_j, t \), puis substituer cette expression dans (2.4).
    </p>
    <p>
        Nous appellerons \( H \) la fonction de Hamilton. Notons que, pour les systèmes conservatifs (où \( L \) ne dépend pas explicitement de t, donc \( \partial L/\partial t = 0 \)), la définition (2.4) de la fonction de Hamilton coïncide avec celle de l'énergie totale \( E \) (1.67). En revanche, pour des systèmes où la fonction de Lagrange dépend explicitement du temps, la notion d'énergie mécanique totale perd tout son intérêt, alors que la fonction de Hamilton garde son sens et permet toujours d'écrire les équations du mouvement. C'est ce caractère plus général de la fonction de Hamilton qui justifie de ne pas la confondre avec l'énergie totale. La différentielle de la fonction de Hamilton s'écrit sans difficulté comme:
        $$ dH = d\left(\sum_i p_i \dot{q}_i\right) - dL = \sum_i (\dot{q}_i dp_i + p_i d\dot{q}_i) - \left( \sum_i (\dot{p}_i dq_i + p_i d\dot{q}_i) + \frac{\partial L}{\partial t} dt \right) $$
        $$ dH = \sum_i (\dot{q}_i dp_i - \dot{p}_i dq_i) - \frac{\partial L}{\partial t} dt \quad (2.5) $$
    </p>
    <p>
        \( H \) apparaît donc comme une fonction naturelle des \( p_i \) et \( q_i \) (et de \( t \)) dont les dérivées partielles respectives sont les \( \dot{q}_i \) et les \( -\dot{p}_i \). En identifiant cette différentielle avec l'expression générale \( dH = \sum_i (\frac{\partial H}{\partial q_i} dq_i + \frac{\partial H}{\partial p_i} dp_i) + \frac{\partial H}{\partial t} dt \), on obtient les \( 2n \) <strong>équations de Hamilton</strong>, équivalentes aux \( n \) équations de Lagrange, qui permettent la résolution du problème avec les conditions aux limites:
        $$ \dot{q}_i = \frac{\partial H}{\partial p_i} \quad (2.6) $$
        $$ \dot{p}_i = -\frac{\partial H}{\partial q_i} \quad (2.7) $$
        auxquelles on pourrait ajouter la relation \( \partial H/\partial t = -\partial L/\partial t \), qui ne présente d'intérêt que pour un lagrangien et donc un hamiltonien dépendant explicitement du temps. Les positions \( q_i \) et les impulsions \( p_i \) sont dites <strong>variables conjuguées</strong>.
    </p>
    <p>
        Comme attendu, nous avons donc remplacé les \( n \) équations différentielles du second ordre que nous donne le formalisme lagrangien, par un nombre double d'équations différentielles du premier ordre qui se prêtent plus facilement à une résolution analytique ou numérique. Les conditions initiales naturelles pour ces équations sont les positions et les impulsions initiales \( (q_i(0), p_i(0)) \) (alors que c'étaient les positions et les vitesses initiales pour les équations de Lagrange). Rappelons que les impulsions \( p_i \) ne coïncident pas nécessairement avec les quantités de mouvement \( m_i \dot{q}_i \), en particulier en présence de champs électromagnétiques).
    </p>
    <p class="footnote">
        <sup>1</sup> Nous supposerons très souvent dans ce chapitre que la fonction de Lagrange ne dépend pas explicitement du temps. L'énergie mécanique totale (égale à H) est alors une intégrale première du mouvement.
    </p>
     <p class="footnote">
        <sup>2</sup> C'est en effet la transformation qui permet, par exemple, de passer de l'énergie interne \( U(S, V) \), dont la différentielle \( dU=TdS-PdV \) s'exprime simplement en fonction de celles du volume et de l'entropie, à l'enthalpie \( H(S, P) = U+PV \), dont la différentielle \( dH=TdS+VdP \) fait intervenir pression et entropie comme variables naturelles.
    </p>

     <!-- ===================================================================== -->
    <!-- Page 47 -->
    <!-- ===================================================================== -->
    <p>
        Notons enfin la symétrie remarquable de ces équations, qui traitent de façon tout à fait analogue les positions et les impulsions (à un signe près).
    </p>
    <p>
        Notons aussi que si \( q_i \) est une coordonnée cyclique (\( \partial L/\partial q_i = 0 \)), alors l'hamiltonien \( H \) ne dépend pas explicitement de \( q_i \) (car \( \dot{p}_i = \partial L/\partial q_i = -\partial H/\partial q_i \)). On déduit alors immédiatement de l'équation de Hamilton (2.7) que \( \dot{p}_i = -\partial H/\partial q_i = 0 \), et donc \( p_i \) est une constante du mouvement.
    </p>
    <p>
        Examinons maintenant le cas particulier où les forces dérivent d'une énergie potentielle \( U(q) \) ne dépendant que des positions et où les coordonnées généralisées coïncident avec les coordonnées cartésiennes \( \mathbf{r}_\alpha \). La fonction de Lagrange s'écrit \( L = T - U \) avec \( T = \sum \frac{1}{2} m_\alpha v_\alpha^2 \) et les impulsions généralisées coïncident avec la définition habituelle \( \mathbf{p}_\alpha = m_\alpha \mathbf{v}_\alpha \). La fonction de Hamilton, qui est identique à l'énergie totale, s'écrit alors \( H = T + U = \sum_\alpha \frac{\mathbf{p}_\alpha^2}{2m_\alpha} + U(\mathbf{r}_\alpha) \) et les équations de Hamilton s'écrivent:
        $$ \nabla_{\mathbf{p}_\alpha} H = \dot{\mathbf{r}}_\alpha \quad (2.8) $$
        $$ \nabla_{\mathbf{r}_\alpha} H = -\dot{\mathbf{p}}_\alpha \quad (2.9) $$
        En écrivant \( H = \sum_\alpha \mathbf{p}_\alpha^2/(2m_\alpha) + U \), on en déduit:
        $$ \frac{\mathbf{p}_\alpha}{m_\alpha} = \mathbf{v}_\alpha \quad (2.10) $$
        $$ \nabla_{\mathbf{r}_\alpha} U = \mathbf{F}_\alpha = -\dot{\mathbf{p}}_\alpha \quad (2.11) $$
        La première de ces deux équations de Hamilton n'est autre que la définition de l'impulsion en termes de la vitesse. La deuxième n'est autre que le principe fondamental de la dynamique (\( \mathbf{F} = \dot{\mathbf{p}} \)). Dans ce cas très simple, l'écriture des équations de Hamilton à partir des équations de Newton revient à prendre comme variables indépendantes position et impulsion (au lieu de position et vitesse), un changement de variable bien connu pour transformer les équations différentielles du second ordre en équations du premier ordre.
    </p>
    <p>
        Examinons maintenant un autre cas très important: celui de particules chargées dans un champ électromagnétique. Nous supposerons encore que les coordonnées sont les coordonnées cartésiennes habituelles. Nous avons montré au chapitre précédent que la fonction de Lagrange s'écrit:
        $$ L = \sum_\alpha (T_\alpha - q_\alpha V_\alpha + q_\alpha \mathbf{A}_\alpha \cdot \mathbf{v}_\alpha), \quad (2.12) $$
        où \( V_\alpha \) et \( \mathbf{A}_\alpha \) sont les potentiels scalaires et vecteur vus par la particule \( \alpha \).
    </p>
    <p>
        Pour passer aux équations de Hamilton, la première étape est de déterminer l'impulsion généralisée (ou canonique) \( \mathbf{p}_\alpha \):
        $$ \mathbf{p}_\alpha = \nabla_{\mathbf{v}_\alpha} L = m_\alpha \mathbf{v}_\alpha + q_\alpha \mathbf{A}_\alpha . \quad (2.13) $$
        On voit bien que, sauf dans le cas de l'électrostatique (\( \mathbf{A}=0 \)), l'impulsion généralisée ne coïncide pas avec la quantité de mouvement ordinaire \( m_\alpha \mathbf{v}_\alpha \).
    </p>
    <p>
        On peut alors écrire sans difficultés la fonction de Hamilton \( H = \sum \mathbf{p}_\alpha \cdot \mathbf{v}_\alpha - L \). Comme nous l'avons vu (éq. 1.73), cela donne simplement \( H = T + U_{electrostatique} \):
        $$ H = \sum_\alpha \left(\frac{1}{2} m_\alpha v_\alpha^2 + q_\alpha V_\alpha \right). \quad (2.14) $$
        De façon très remarquable, la fonction de Hamilton écrite sous cette forme ne fait pas intervenir le potentiel vecteur magnétique. En effet, au moins dans le cas où les potentiels sont statiques, nous avons vu au chapitre précédent que l'énergie totale conservée des particules est la somme de leur énergie cinétique et de l'énergie potentielle électrostatique. On pourrait craindre qu'une telle fonction de Hamilton ne conduise à des équations du mouvement qui ne font plus intervenir le champ magnétique. Bien sûr il n'en est rien. On doit en effet, pour écrire les équations de Hamilton, exprimer \( H \) comme une fonction des impulsions généralisées \( \mathbf{p}_\alpha \), non pas des vitesses \( \mathbf{v}_\alpha \). En utilisant le lien (2.13) entre impulsion et vitesse, \( \mathbf{v}_\alpha = (\mathbf{p}_\alpha - q_\alpha \mathbf{A}_\alpha) / m_\alpha \), on obtient:
        $$ H = \sum_\alpha \left[ \frac{(\mathbf{p}_\alpha - q_\alpha \mathbf{A}_\alpha)^2}{2m_\alpha} + q_\alpha V_\alpha \right] \quad (2.15) $$
        C'est sous cette forme que l'Hamiltonien fait intervenir le potentiel vecteur \( \mathbf{A}_\alpha \).
    </p>

    <!-- ===================================================================== -->
    <!-- Page 48 -->
    <!-- ===================================================================== -->
    <p>
        Cette expression du hamiltonien de particules dans un champ nous sera utile dans la quatrième partie. Nous aurons en effet besoin du hamiltonien quantique d'un atome dans un champ de rayonnement. Nous utiliserons simplement l'expression précédente, en remplaçant toutes les quantités relatives à la particule par les opérateurs quantiques correspondants.
    </p>
    <p>
        A titre d'exercice, écrivons les équations du mouvement à partir de cette expression du hamiltonien, et vérifions que nous retrouvons bien la force de Lorentz habituelle. Pour alléger les notations, nous ne considérerons que le cas d'une particule unique et nous omettrons donc l'indice \( \alpha \). Le lecteur pourra aisément rétablir le cas général.
    </p>
    <p>
        Notons d'abord qu'une des équations de Hamilton ( \( \dot{\mathbf{r}} = \partial H / \partial \mathbf{p} \) ) redonne trivialement, comme dans le cas d'un potentiel standard, la définition de l'impulsion généralisée en termes de la vitesse: \( \dot{\mathbf{r}} = (\mathbf{p} - q\mathbf{A})/m \Rightarrow \mathbf{p} = m\dot{\mathbf{r}} + q\mathbf{A} \). Nous nous focaliserons donc sur l'autre équation, \( \dot{\mathbf{p}} = -\nabla H \), qui s'écrit:
        $$ \dot{\mathbf{p}} = -\nabla H = -\nabla \left( \frac{(\mathbf{p} - q\mathbf{A})^2}{2m} + qV \right) \quad (2.16) $$
        où les gradients \( \nabla \) s'entendent par rapport à la position \( \mathbf{r} \) de la particule (A et V dépendent de r). Le gradient du carré scalaire peut se développer comme gradient d'un produit scalaire (en utilisant \( \nabla(\mathbf{u}^2) = 2(\mathbf{u}\cdot\nabla)\mathbf{u} + 2\mathbf{u}\times(\nabla\times\mathbf{u}) \) avec \( \mathbf{u} = \mathbf{p}-q\mathbf{A} \)):
        $$ \nabla(\mathbf{p}-q\mathbf{A})^2 = 2 [ ((\mathbf{p}-q\mathbf{A})\cdot\nabla) (-q\mathbf{A}) + (\mathbf{p}-q\mathbf{A}) \times (\nabla\times(-q\mathbf{A})) ] $$
        $$ \nabla(\mathbf{p}-q\mathbf{A})^2 = 2m [ (\mathbf{v}\cdot\nabla) (-q\mathbf{A}) + \mathbf{v} \times (-q\mathbf{B}) ] = -2mq [ (\mathbf{v}\cdot\nabla)\mathbf{A} + \mathbf{v} \times \mathbf{B} ] \quad (2.17 \text{ simplifié}) $$
        Dans cette équation, seul le potentiel vecteur \( \mathbf{A} \) est à considérer comme une fonction de \( \mathbf{r} \). On peut alors simplifier cette expression et la dérivée de l'impulsion s'écrit, en faisant intervenir la vitesse de la particule \( \mathbf{v} = (\mathbf{p}-q\mathbf{A})/m \):
        $$ \dot{\mathbf{p}} = - \frac{1}{2m} (-2mq [ (\mathbf{v}\cdot\nabla)\mathbf{A} + \mathbf{v} \times \mathbf{B} ]) - q\nabla V $$
        $$ \dot{\mathbf{p}} = q(\mathbf{v}\cdot\nabla)\mathbf{A} + q\mathbf{v} \times \mathbf{B} - q\nabla V \quad (2.18 \text{ corrigé}) $$
    </p>
    <p>En nous souvenant que:</p>
        $$ -\nabla V = \mathbf{E} + \frac{\partial \mathbf{A}}{\partial t} \quad (2.19) $$
    <p>et que la dérivée totale de A (dérivée hydrodynamique) est</p>
        $$ \frac{d\mathbf{A}}{dt} = \frac{\partial \mathbf{A}}{\partial t} + (\mathbf{v}\cdot\nabla)\mathbf{A} \quad (2.20 \text{ adapté}) $$
    <p>on a</p>
        $$ \dot{\mathbf{p}} = q \left( \frac{d\mathbf{A}}{dt} - \frac{\partial \mathbf{A}}{\partial t} \right) + q\mathbf{v} \times \mathbf{B} - q\nabla V $$
        $$ \dot{\mathbf{p}} = q \frac{d\mathbf{A}}{dt} + q\mathbf{v} \times \mathbf{B} + q \left( -\frac{\partial \mathbf{A}}{\partial t} - \nabla V \right) = q \frac{d\mathbf{A}}{dt} + q\mathbf{E} + q\mathbf{v} \times \mathbf{B} $$
    <p>
        Si enfin on exprime la variation de l'impulsion \( \dot{\mathbf{p}} = \frac{d}{dt}(m\mathbf{v} + q\mathbf{A}) = m\dot{\mathbf{v}} + q\frac{d\mathbf{A}}{dt} \) en fonction de l'accélération, on retrouve bien le principe fondamental avec la force de Lorentz sous sa forme standard:
        $$ m\dot{\mathbf{v}} + q\frac{d\mathbf{A}}{dt} = q \frac{d\mathbf{A}}{dt} + q\mathbf{E} + q\mathbf{v} \times \mathbf{B} \quad \Rightarrow \quad m\dot{\mathbf{v}} = q\mathbf{E} + q\mathbf{v} \times \mathbf{B} \quad (2.21 \text{ adapté}) $$
        Si nous ne doutions guère du résultat, il était important de l'établir explicitement. Il nous a fait bien sentir la différence essentielle entre quantité de mouvement (au sens de la dynamique newtonienne \( m\mathbf{v} \)) et impulsion généralisée (canonique \( \mathbf{p} \)).
    </p>

    <h4>2.2 Crochets de Poisson</h4>
    <p>
        Nous allons introduire dans ce paragraphe une notation que nous n'utiliserons guère dans ce cours, très élémentaire, de mécanique analytique. En revanche, l'analogie et le lien formel très important entre ces crochets de Poisson et les commutateurs de la mécanique quantique rendent importante leur introduction à ce point. Nous préciserons d'ailleurs rapidement ces liens.
    </p>
    <p>
        Considérons une fonction \( f(q_i, p_i, t) \) quelconque des impulsions, des positions et du temps. On peut en écrire la dérivée totale par rapport au temps, le long de la trajectoire suivie par le système, sous la forme:
        $$ \frac{df}{dt} = \frac{\partial f}{\partial t} + \sum_i \left( \frac{\partial f}{\partial q_i} \dot{q}_i + \frac{\partial f}{\partial p_i} \dot{p}_i \right). \quad (2.22) $$
    </p>

     <!-- ===================================================================== -->
    <!-- Page 49 -->
    <!-- ===================================================================== -->
    <p>
        En utilisant les équations de Hamilton \( \dot{q}_i = \partial H/\partial p_i \) et \( \dot{p}_i = -\partial H/\partial q_i \), nous mettrons cette dérivée sous la forme:
        $$ \frac{df}{dt} = \frac{\partial f}{\partial t} + \sum_i \left( \frac{\partial f}{\partial q_i} \frac{\partial H}{\partial p_i} - \frac{\partial f}{\partial p_i} \frac{\partial H}{\partial q_i} \right) $$
        Définissons le <strong>crochet de Poisson</strong> de \( f \) avec \( H \) par:
        $$ \{f, H\} = \sum_i \left( \frac{\partial f}{\partial q_i} \frac{\partial H}{\partial p_i} - \frac{\partial f}{\partial p_i} \frac{\partial H}{\partial q_i} \right) . \quad (2.24 \text{ standard}) $$
        Alors l'évolution temporelle de \( f \) s'écrit:
        $$ \frac{df}{dt} = \frac{\partial f}{\partial t} + \{f, H\} . \quad (2.23 \text{ standard}) $$
        <em>(Note: Le PDF utilise la convention \( \{H, f\}_{PDF} = - \{f, H\} \). La formulation (2.23) est cohérente avec (2.24) si le crochet est défini comme \( \{f, H\} \). C'est la convention la plus courante.)</em>
    </p>
    <p>
        Le crochet de Poisson est une forme bilinéaire antisymétrique de ses arguments. C'est aussi le cas des commutateurs entre opérateurs en mécanique quantique. Au delà d'une simple remarque mathématique et d'une évidente analogie de notations, nous allons, tout au long de ce paragraphe, rencontrer de nombreuses similitudes entre crochets de Poisson et commutateurs. En fait les uns sont la version classique des autres (la correspondance étant \( \{f, g\} \leftrightarrow \frac{1}{i\hbar} [\hat{f}, \hat{g}] \)).
    </p>
    <p>
        Notons également que les crochets de Poisson peuvent être utilisés pour décrire l'évolution temporelle d'une densité de probabilité dans l'espace des phases. En effet, si \( W(p_i, q_i, t) \) représente la densité de probabilité pour que le système se trouve au point \( (q_i, p_i) \) de l'espace des phases à l'instant t, \( W \) évolue dans le temps selon l'<strong>équation de Liouville</strong>:
        $$ \frac{\partial W}{\partial t} = -\{W, H\} \quad (= \{H, W\}_{PDF}) . \quad (2.25) $$
        Cette équation exprime la conservation de la densité de probabilité le long des trajectoires hamiltoniennes.
    </p>
    <p>
        Supposons que la fonction \( f \) ne fasse pas intervenir explicitement le temps (\( \partial f / \partial t = 0 \)). La condition nécessaire et suffisante pour que \( f \) soit une intégrale première du mouvement (\( df/dt = 0 \)) est alors que \( \{f, H\} = 0 \). La nullité du crochet de Poisson avec la fonction de Hamilton est équivalente avec la constance de la fonction. Cette propriété est à rapprocher de son équivalent quantique: la condition pour qu'un opérateur \( \hat{F} \) (ne dépendant pas explicitement du temps) soit une constante du mouvement est en effet que son commutateur \( [\hat{H}, \hat{F}] \) avec le hamiltonien s'annule.
    </p>
    <p>
        On peut bien sûr définir le crochet de Poisson de deux fonctions quelconques \( f, g \) des positions, des impulsions et du temps, estimées sur la trajectoire du système:
        $$ \{f, g\} = \sum_i \left( \frac{\partial f}{\partial q_i} \frac{\partial g}{\partial p_i} - \frac{\partial f}{\partial p_i} \frac{\partial g}{\partial q_i} \right) . \quad (2.26) $$
    </p>
    <p>On déduit de cette expression les propriétés essentielles de l'algèbre des crochets de Poisson:</p>
    <ul>
        <li>Antisymétrie: \( \{f, g\} = -\{g, f\} \) (Eq 2.27)</li>
        <li>Nullité avec une constante: \( \{f, C\} = 0 \) (Eq 2.28)</li>
        <li>Bilinéarité: \( \{f + f', g\} = \{f, g\} + \{f', g\} \) (Eq 2.29), \( \{Cf, g\} = C\{f, g\} \) (Eq 2.30)</li>
        <li>Règle de Leibniz: \( \{fg, h\} = f\{g, h\} + \{f, h\}g \)</li>
        <li>Crochets fondamentaux:
            $$ \{f, q_k\} = -\frac{\partial f}{\partial p_k} \quad (2.31) $$
            $$ \{f, p_k\} = \frac{\partial f}{\partial q_k} \quad (2.32) $$
        </li>
    </ul>
    <p>où \( C \) est une constante arbitraire. On en déduit facilement les crochets de Poisson des impulsions et positions:</p>
    <ul>
        <li>\( \{q_i, q_k\} = 0 \) (Eq 2.33)</li>
        <li>\( \{p_i, p_k\} = 0 \) (Eq 2.34)</li>
        <li>\( \{q_i, p_k\} = \delta_{ik} \) (Eq 2.35)</li>
    </ul>

    <!-- ===================================================================== -->
    <!-- Page 50 -->
    <!-- ===================================================================== -->
    <p>
        Il est intéressant de noter la similitude entre ces "relations de commutation" classiques et leur analogue quantique \( [\hat{q}_i, \hat{p}_k] = i\hbar\delta_{ik} \), \( [\hat{q}_i, \hat{q}_k] = 0 \), \( [\hat{p}_i, \hat{p}_k] = 0 \). De façon très générale, nous verrons que les crochets de Poisson des quantités classiques coïncident, à un facteur \( i\hbar \) près, avec les commutateurs des opérateurs quantiques correspondants: \( [\hat{f}, \hat{g}] \leftrightarrow i\hbar \{f, g\} \).
    </p>
    <p>Notons une dernière propriété utile des crochets de Poisson, la <strong>relation de Jacobi</strong>:</p>
    $$ \{f, \{g, k\}\} + \{g, \{k, f\}\} + \{k, \{f, g\}\} = 0 \quad (2.36) $$
    (nullité de la somme de tous les crochets de Poisson obtenus par permutation circulaire des trois fonctions).
    <p>
        Comme nous l'avons déjà mentionné, les crochets de Poisson sont utiles pour la recherche des intégrales premières du mouvement. Précisons encore ce point en montrant que si \( f \) et \( g \) sont deux intégrales premières du mouvement (sans dépendance explicite en temps, donc \( \{f, H\} = 0 \) et \( \{g, H\} = 0 \)), leur crochet de Poisson \( \{f, g\} \) est aussi une intégrale première. En d'autres termes, nous allons montrer que, si \( df/dt = 0 \) et \( dg/dt = 0 \), alors \( d\{f, g\}/dt = 0 \). Nous avons (puisque \( \{f,g\} \) ne dépend pas explicitement de t si f et g n'en dépendent pas):
        $$ \frac{d}{dt}\{f, g\} = \{\{f, g\}, H\} $$
        En utilisant l'identité de Jacobi (2.36) avec \( k=H \) et l'antisymétrie:
        $$ \{\{f, g\}, H\} = - \{g, \{H, f\}\} - \{H, \{f, g\}\} $$
        Or, \( \{H, f\} = -\{f, H\} = 0 \) et \( \{H, g\} = -\{g, H\} = 0 \). Donc:
        $$ \frac{d}{dt}\{f, g\} = - \{g, -\{f, H\}\} - \{H, \{f, g\}\} $$
        $$ \frac{d}{dt}\{f, g\} = -\{g, 0\} - \{f, \{g, H\}\} = 0 - \{f, 0\} = 0. \quad (2.37 \text{ adapté}) $$
    </p>
    <p>
        Si donc on connaît deux intégrales premières du mouvement, on peut en trouver en principe une troisième en prenant leur crochet de Poisson. Rien ne garantit néanmoins que cette troisième intégrale ne soit triviale (nulle en particulier) ou déjà connue. Notons là encore qu'il existe un analogue quantique évident à cette propriété: si deux opérateurs \( \hat{F}, \hat{G} \) commutent avec le hamiltonien (et sont donc des constantes du mouvement), alors leur commutateur \( [\hat{F}, \hat{G}] \) commute lui aussi avec le hamiltonien et donne une troisième constante du mouvement.
    </p>
    <p>
        Pour clore ce paragraphe, considérons brièvement le cas des trois composantes \( L_x, L_y \) et \( L_z \) du moment cinétique total \( \mathbf{L} \). Nous nous placerons, pour fixer les idées, dans le cas d'une particule unique \( \mathbf{L} = \mathbf{r} \times \mathbf{p} \), et nous laisserons les généralisations au lecteur. On en déduit \( L_x = y p_z - z p_y \), \( L_y = z p_x - x p_z \), \( L_z = x p_y - y p_x \). Le crochet de Poisson \( \{L_x, L_y\} \) fait intervenir les dérivées partielles des composantes concernées du moment cinétique par rapport aux composantes de la position et de l'impulsion. L'expression des composantes du moment cinétique permet de calculer facilement ces dérivées. Après un calcul sans grand intérêt, on obtient:
        $$ \{L_x, L_y\} = L_z \quad (2.38 \text{ standard}) $$
        et les trois relations se déduisant de celle ci par permutation circulaire des indices (\( \{L_y, L_z\} = L_x \), \( \{L_z, L_x\} = L_y \)). Notons, une fois de plus, l'analogie entre ces équations et leur contrepartie quantique:
        $$ [\hat{L}_x, \hat{L}_y] = i\hbar \hat{L}_z, \quad (2.39) $$
        relations d'une très grande importance puisqu'elles définissent ce qu'est un moment cinétique quantique.
    </p>
    <p>
        Nous avons vu au chapitre précédent que l'invariance par rotation arbitraire autour d'un axe impliquait la conservation de la composante du moment cinétique sur cet axe. Imaginons qu'on ait pu montrer la conservation de \( L_x \) et \( L_y \) (par exemple, \( \{L_x, H\}=0 \) et \( \{L_y, H\}=0 \)). Il en résulte, comme nous venons de le montrer, la conservation de leur crochet de Poisson, c'est à dire de \( L_z \), car \( \{L_z, H\} = \{\{L_x, L_y\}, H\} = 0 \). Il suffit en fait que le moment par rapport à deux axes perpendiculaires soit conservé pour que le moment cinétique total le soit.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 51 -->
    <!-- ===================================================================== -->
    <h4>2.3 Action et hamiltonien</h4>
    <p>
        Nous pouvons aussi appliquer ces relations à l'étude d'un problème dynamique important. Nous considérerons un système dynamique dont le hamiltonien peut s'écrire \( H = \boldsymbol{\Omega} \cdot \mathbf{L} \), où \( \boldsymbol{\Omega} \) est un vecteur constant. C'est par exemple le hamiltonien d'une particule dont le moment cinétique est proportionnel au dipôle magnétique (\( \boldsymbol{\mu} = \gamma \mathbf{L} \)), quand elle est plongée dans un champ magnétique uniforme \( \mathbf{B} \) ( \( H = -\boldsymbol{\mu} \cdot \mathbf{B} = -(\gamma \mathbf{B}) \cdot \mathbf{L} \), donc \( \boldsymbol{\Omega} = -\gamma \mathbf{B} \)). C'est le problème de la "<strong>précession de Larmor</strong>", dont la version quantique est d'une grande importance dans la compréhension de l'effet Zeeman. Les seules variables dynamiques importantes sont les composantes du moment cinétique. On peut écrire l'évolution de L:
        $$ \frac{d\mathbf{L}}{dt} = \{\mathbf{L}, H\} = \{\mathbf{L}, \boldsymbol{\Omega} \cdot \mathbf{L}\} \quad (2.40) $$
        En utilisant les relations de crochets de poisson entre les composantes de \( \mathbf{L} \), on a, par exemple pour la composante x :
        $$ \frac{dL_x}{dt} = \{L_x, \Omega_x L_x + \Omega_y L_y + \Omega_z L_z \} = \Omega_y \{L_x, L_y\} + \Omega_z \{L_x, L_z\} = \Omega_y L_z - \Omega_z L_y = -(\boldsymbol{\Omega} \times \mathbf{L})_x \quad (2.41 \text{ corrigé}) $$
        <em>[Note: Le PDF a \( \Omega_y L_z - \Omega_z L_y = (\Omega \times L)_x \). C'est correct. Donc le PDF a le bon signe.]</em>
        soit encore vectoriellement (en utilisant \( \frac{dL_i}{dt} = \{L_i, \sum_j \Omega_j L_j\} = \sum_j \Omega_j \{L_i, L_j\} = \sum_{j,k} \Omega_j \epsilon_{ijk} L_k = (\boldsymbol{\Omega} \times \mathbf{L})_i \)):
        $$ \frac{d\mathbf{L}}{dt} = \boldsymbol{\Omega} \times \mathbf{L} . \quad (2.42) $$
        On retrouve aisément que le moment cinétique précesse autour du vecteur fixe \( \boldsymbol{\Omega} \) avec une pulsation \( \Omega \).
    </p>

    <h4>2.3 Action et hamiltonien</h4>
    <p>
        Nous allons revenir sur le principe variationnel. Nous allons écrire l'action en fonction du hamiltonien, et montrer qu'on peut retrouver les équations de Hamilton en écrivant la stationnarité de cette expression de l'action par rapport à certaines variations infinitésimales de la trajectoire. Ce paragraphe ne nous apprendra rien que nous ne sachions déjà, mais il est nécessaire à la cohérence de tout notre édifice.
    </p>
    <p>
        Le lien \( L = \sum p_i \dot{q}_i - H \) entre fonction de Lagrange et fonction de Hamilton nous permet d'écrire l'action sous la forme:
        $$ S = \int_{t_1}^{t_2} L dt = \int_{t_1}^{t_2} \left( \sum_i p_i \dot{q}_i - H(q, p, t) \right) dt, \quad (2.43) $$
        avec les notations du premier chapitre.
    </p>
    <p>
        Ecrivons maintenant, pour retrouver les équations de Hamilton, que l'action est stationnaire pour la trajectoire effectivement suivie. L'accroissement \( \delta S \) de l'action dans un accroissement infinitésimal de la trajectoire doit donc s'annuler. Nous considérerons donc deux trajectoires dans l'espace des phases \( (q_i, p_i) \). La trajectoire de référence est la trajectoire effectivement suivie, définie par \( q_i(t) \) et \( p_i(t) \). L'autre trajectoire (infiniment proche) est définie à chaque instant par \( q_i(t) + \delta q_i(t) \) et \( p_i(t) + \delta p_i(t) \). Nous imposerons aux deux trajectoires de coïncider aux instants initial et final pour les positions: \( \delta q_i(1) = \delta q_i(2) = 0 \). Il est naturel de considérer, dans une approche hamiltonienne, les \( p_i \) et les \( q_i \) comme des variables indépendantes. Nous n'imposerons donc aucune condition aux variations \( \delta p_i \), ni aux extrémités de la trajectoire, ni à aucun instant. Il faut bien voir que nous pouvons ainsi considérer des trajectoires variées qui n'auraient pas de sens du point de vue de la simple cinématique: si les impulsions coïncident avec les quantités de mouvement (\( m\mathbf{v} \)), varier les impulsions indépendamment des positions implique que, sur la trajectoire variée, les vitesses puissent ne plus être égales aux dérivées des positions (avec une différence au premier ordre dans les petits accroissements). Ce n'est qu'au prix de cette liberté toute mathématique que nous pourrons retrouver l'équation de Hamilton qui contient en fait la définition des impulsions généralisées (de la vitesse dans le cas très simple que nous venons de mentionner).
    </p>
    <p>
        Avec ces notations, l'accroissement de l'action s'écrit simplement:
        $$ \delta S = \int_{t_1}^{t_2} \delta \left( \sum_i p_i \dot{q}_i - H \right) dt = \int_{t_1}^{t_2} \left( \sum_i (\delta p_i \dot{q}_i + p_i \delta \dot{q}_i) - \delta H \right) dt . \quad (2.44) $$
    </p>

     <!-- ===================================================================== -->
    <!-- Page 52 -->
    <!-- ===================================================================== -->
    <p>L'accroissement de H entre la trajectoire de référence et la trajectoire variée s'écrit simplement:</p>
        $$ \delta H = \sum_i \left( \frac{\partial H}{\partial q_i} \delta q_i + \frac{\partial H}{\partial p_i} \delta p_i \right) \quad (2.45) $$
    <p>On peut donc mettre \( \delta S \) sous la forme:</p>
        $$ \delta S = \int_{t_1}^{t_2} \left( \sum_i \delta p_i \dot{q}_i + \sum_i p_i \delta \dot{q}_i - \sum_i \frac{\partial H}{\partial q_i} \delta q_i - \sum_i \frac{\partial H}{\partial p_i} \delta p_i \right) dt $$
        $$ \delta S = \int_{t_1}^{t_2} \sum_i \left( \dot{q}_i - \frac{\partial H}{\partial p_i} \right) \delta p_i dt + \int_{t_1}^{t_2} \sum_i \left( p_i \delta \dot{q}_i - \frac{\partial H}{\partial q_i} \delta q_i \right) dt . \quad (2.46 \text{ adapté}) $$
    <p>
        Considérons plus particulièrement le premier terme (\( p_i \delta \dot{q}_i \)) de la deuxième intégrale. On peut l'intégrer par parties pour faire apparaître \( \delta q_i \) au lieu de \( \delta \dot{q}_i \): \( \int_{t_1}^{t_2} p_i \delta \dot{q}_i dt = [p_i \delta q_i]_{t_1}^{t_2} - \int_{t_1}^{t_2} \dot{p}_i \delta q_i dt \). Le terme tout intégré dans cette intégration par parties fait intervenir les accroissements \( \delta q_i \) aux instants \( t_1 \) et \( t_2 \). Il est donc identiquement nul car \( \delta q_i(t_1) = \delta q_i(t_2) = 0 \). En regroupant alors les termes proportionnels aux accroissements des positions et des impulsions, on peut écrire:
        $$ \delta S = \int_{t_1}^{t_2} \sum_i \left( \dot{q}_i - \frac{\partial H}{\partial p_i} \right) \delta p_i dt - \int_{t_1}^{t_2} \sum_i \left( \dot{p}_i + \frac{\partial H}{\partial q_i} \right) \delta q_i dt . \quad (2.47) $$
    </p>
    <p>
        \( \delta S \) ne s'annulera quels que soient les accroissements des positions \( \delta q_i \) et impulsions \( \delta p_i \) (qui sont indépendants) que si les termes entre crochets dans chaque intégrale s'annulent identiquement sur la trajectoire effectivement suivie. On montre bien ainsi que cette trajectoire obéit effectivement aux équations de Hamilton \( \dot{q}_i = \partial H / \partial p_i \) et \( \dot{p}_i = -\partial H / \partial q_i \), que nous aurions parfaitement pu établir par ce raisonnement (principe de Hamilton pour l'espace des phases).
    </p>
    <p>
        Il existe, dans le cadre de la formulation hamiltonienne, un autre principe variationnel, le <strong>principe de Maupertuis</strong> (ou principe de moindre action sous forme réduite), qui permet de trouver la forme de la trajectoire, mais pas la loi horaire. Ce principe s'apparente de très près à celui de Fermat, qui permet de déterminer en optique la trajectoire des rayons lumineux. Nous n'aborderons pas ici le principe de Maupertuis, largement discuté dans les manuels<sup>3</sup>.
    </p>

    <h4>2.4 Transformations canoniques</h4>
    <p>
        Nous abordons ici ce qui constitue sans doute l'intérêt essentiel de la formulation hamiltonienne. La complète symétrie entre les positions et impulsions va en effet nous permettre d'envisager des changements de variables mêlant ces deux types de quantités. Nous verrons qu'on peut ainsi rendre complètement triviale la dynamique d'un problème, en prenant par exemple comme nouvelles variables les conditions initiales. Bien sûr, la difficulté est de trouver le bon changement de variables. Nous n'aborderons pas, faute de place, les méthodes permettant de les déterminer (fonctions génératrices, crochets de Lagrange). Nous profiterons également de ce paragraphe pour établir le théorème de Liouville, qui joue un rôle central en physique statistique et dans l'étude de la dynamique des systèmes complexes.
    </p>

    <h5>2.4.1 Principe</h5>
    <p>
        Revenons un instant au formalisme lagrangien. Les \( q_i \) et leurs vitesses \( \dot{q}_i \) ne sont pas des variables indépendantes (via les équations de Lagrange). Le seul type de changement de variable que l'on puisse envisager est donc de définir de nouvelles coordonnées généralisées \( Q_i \), calculables à partir des \( q_j \) et du temps (\( Q_i = Q_i(q_j, t) \)) (la relation étant inversible). On peut alors écrire la fonction de Lagrange en fonction des \( Q_i \), les équations de Lagrange correspondantes et résoudre ainsi le problème – en espérant qu'il soit plus simple en terme des nouvelles variables. Nous appellerons une telle transformation des coordonnées généralisées une "<strong>transformation ponctuelle</strong>". Nous allons maintenant voir qu'elle appartient à un cadre beaucoup plus général.
    </p>
    <p>
        Dans le formalisme hamiltonien, les variables indépendantes sont les \( q_i \) et les \( p_i \). Nous pouvons imaginer un changement de variables très général sous la forme \( q_i, p_i \to Q_i(q_j, p_j, t), P_i(q_j, p_j, t) \).
    </p>
     <p class="footnote">
        <sup>3</sup> On consultera en particulier le Goldstein.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 53 -->
    <!-- ===================================================================== -->
    <p>
        Les définitions des nouvelles positions \( Q_i \) et des nouvelles impulsions \( P_i \) font intervenir toutes les anciennes positions et impulsions. Ce changement de variables nous laisse donc toute liberté. Nous exigerons cependant qu'il soit inversible, pour que l'état du système soit déterminé de façon univoque par les nouvelles coordonnées, ce qui impose que les \( Q_i \) et les \( P_i \) soient indépendantes.
    </p>
    <p>
        Pour que ce changement de variable soit utilisable dans un problème de mécanique, il nous faut cependant lui imposer une contrainte supplémentaire. Il faut en effet qu'il existe un nouveau hamiltonien \( H'(Q_i, P_i, t) \) qui donne les équations de Hamilton pour les nouvelles variables: \( \dot{Q}_i = \partial H' / \partial P_i \) et \( \dot{P}_i = -\partial H' / \partial Q_i \). Nous dirons alors que la transformation est "<strong>canonique</strong>".
    </p>
    <p>
        Supposons que \( H' \) existe bien. Le principe variationnel abordé au paragraphe précédent s'écrit (principe de Hamilton \( \delta S = 0 \), avec \( S = \int L dt = \int (\sum p\dot{q} - H) dt \)):
        $$ \delta \int_{t_1}^{t_2} \left( \sum_i p_i \dot{q}_i - H \right) dt = 0 \quad (2.48) $$
        en terme des anciennes variables et
        $$ \delta \int_{t_1}^{t_2} \left( \sum_i P_i \dot{Q}_i - H' \right) dt = 0 \quad (2.49) $$
        en termes des nouvelles. Pour que ces deux principes variationnels donnent les mêmes équations du mouvement, il suffit que les deux quantités intégrées ne diffèrent que de la dérivée totale par rapport au temps d'une fonction arbitraire \( F \), appelée <strong>fonction génératrice</strong>. En effet, cette différence ne contribue aux intégrales que par un terme de la forme \( F(2) - F(1) \), qui ne varie pas quand on varie la trajectoire (les variations étant nulles aux extrémités). On peut mettre cette condition sous la forme:
        $$ \sum_i p_i \dot{q}_i - H = \sum_i P_i \dot{Q}_i - H' + \frac{dF}{dt}, $$
        ou, en termes de différentielles à un instant donné:
        $$ \sum_i p_i dq_i - H dt = \sum_i P_i dQ_i - H' dt + dF. \quad (2.50 \text{ adapté}) $$
    </p>
    <p>
        \( dF \) étant l'accroissement de \( F \) entre deux instants voisins. Il suffit donc, pour que la transformation soit canonique, qu'il existe une fonction \( F \) telle que:
        $$ dF = \sum_i p_i dq_i - \sum_i P_i dQ_i + (H' - H) dt \quad (2.51) $$
    </p>
    <p>
        La fonction \( F \) peut dépendre de différentes combinaisons des anciennes et nouvelles variables. Si on choisit \( F \) comme une fonction des anciennes positions \( q_i \) et des nouvelles positions \( Q_i \), et du temps, \( F = F_1(q_i, Q_i, t) \), sa différentielle est \( dF_1 = \sum (\frac{\partial F_1}{\partial q_i} dq_i + \frac{\partial F_1}{\partial Q_i} dQ_i) + \frac{\partial F_1}{\partial t} dt \). En comparant avec (2.51), on obtient les relations:
        $$ p_i = \frac{\partial F_1}{\partial q_i}, \quad P_i = -\frac{\partial F_1}{\partial Q_i}, \quad H' = H + \frac{\partial F_1}{\partial t} \quad (2.52 \text{ adapté}) $$
        Si effectivement la donnée d'une fonction \( F_1(q_i, Q_i, t) \) permet, en écrivant les relations aux dérivées partielles précédentes, de déterminer complètement la transformation (c'est-à-dire exprimer \( Q_i, P_i \) en fonction de \( q_j, p_j \)), celle-ci sera une transformation canonique et le nouveau hamiltonien sera connu par \( H' = H + \partial F_1 / \partial t \).
    </p>
    <p>
        Pour montrer que la donnée de \( F_1 \) détermine complètement la transformation, considérons les \( n \) équations \( p_i = \partial F_1(q_j, Q_j, t) / \partial q_i \). On peut, au moins formellement et sauf cas pathologique, les résoudre pour exprimer les \( n \) "inconnues" \( Q_i \) en termes des \( q_j, p_j, t \): \( Q_i = Q_i(q_j, p_j, t) \). On peut alors calculer facilement, en fonction des \( q_j, p_j \) (en y substituant les \( Q_i \) trouvés), les \( n \) dérivées partielles \( -\partial F_1 / \partial Q_i \) qui donnent les nouvelles impulsions \( P_i(q_j, p_j, t) \). Ceci achève de déterminer complètement la transformation. Le nouveau hamiltonien \( H' \) peut alors être calculé (en exprimant \( H \) et \( \partial F_1/\partial t \) en fonction des nouvelles variables \( Q_i, P_i \)) et on peut écrire les équations de Hamilton en termes des nouvelles variables.
    </p>
    <p>
        En résumé, la donnée d'une fonction \( F_1(q_i, Q_i, t) \) (appelée fonction génératrice de type 1) détermine en général de façon univoque une transformation généralisée et assure que cette transformation soit canonique. Enfin, la donnée de \( F_1 \) permet d'exprimer le nouveau hamiltonien. Pour toutes ces raisons \( F \) s'appelle la fonction génératrice de la transformation<sup>4</sup>.
    </p>
    <p class="footnote">
        <sup>4</sup> Nous avons montré qu'à toute fonction génératrice correspond une transformation (sauf cas pathologique, certaines fonctions ne définissant pas une transformation univoque – en particulier les constantes). Nous n'avons pas établi la réciproque (qu'à toute transformation canonique correspond une fonction génératrice), que nous admettrons.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 54 -->
    <!-- ===================================================================== -->
    <p>
        Nous avons choisi ici, de façon naturelle, de définir \( F \) par les variables \( q_i \) et \( Q_i \). On peut imaginer de définir une transformation canonique par un autre couple de variables. \( F_1 \) étant donnée, considérons en effet la fonction \( \Phi \) définie par une transformation de Legendre sur la variable \( Q_i \):
        $$ \Phi(q_i, P_i, t) = F_1(q_i, Q_i, t) + \sum_j P_j Q_j, \quad (2.53 \text{ adapté}) $$
        \( \Phi \) est donc a priori une fonction naturelle des \( q_i, P_i \). On peut s'en convaincre en écrivant sa différentielle:
        $$ d\Phi = dF_1 + \sum_j (Q_j dP_j + P_j dQ_j) $$
        $$ d\Phi = (\sum_i p_i dq_i - \sum_j P_j dQ_j + (H' - H) dt) + \sum_j (Q_j dP_j + P_j dQ_j) $$
        $$ d\Phi = \sum_i p_i dq_i + \sum_j Q_j dP_j + (H' - H) dt . \quad (2.54) $$
    </p>
    <p>
        Les dérivées partielles de \( \Phi = F_2(q_i, P_i, t) \) (fonction génératrice de type 2) sont donc:
        $$ p_i = \frac{\partial F_2}{\partial q_i}, \quad Q_i = \frac{\partial F_2}{\partial P_i}, \quad H' = H + \frac{\partial F_2}{\partial t} \quad (2.55 \text{ adapté}) $$
    </p>
    <p>
        Comme dans le cas précédent, on peut montrer aisément que la donnée de \( F_2(q, P, t) \) et les relations aux dérivées partielles ci-dessus déterminent complètement la transformation canonique. Pour cela, on résout les \( n \) équations \( Q_i = \partial F_2 / \partial P_i \) pour trouver les \( P_i(q_j, Q_j, t) \). En reportant ces expressions dans les \( n \) autres relations \( p_i = \partial F_2 / \partial q_i \), on achève de déterminer la transformation en obtenant les \( p_i(q_j, Q_j, t) \), etc. <em>[Note: La procédure décrite dans le PDF est légèrement différente mais aboutit au même résultat.]</em>
    </p>
    <p>
        Nous laissons au lecteur le soin de montrer qu'il existe encore deux expressions possibles pour une transformation canonique, utilisant deux autres types de fonctions génératrices. L'une fait intervenir \( F_3(p_i, Q_i, t) = F_1 - \sum_j q_j p_j \) et les relations:
        $$ q_i = -\frac{\partial F_3}{\partial p_i}, \quad P_i = -\frac{\partial F_3}{\partial Q_i}, \quad H' = H + \frac{\partial F_3}{\partial t} \quad (2.56 \text{ adapté}) $$
        L'autre utilise la fonction \( F_4(p_i, P_i, t) = F_2 - \sum_j q_j p_j = F_3 + \sum_j P_j Q_j \) et les relations:
        $$ q_i = -\frac{\partial F_4}{\partial p_i}, \quad Q_i = \frac{\partial F_4}{\partial P_i}, \quad H' = H + \frac{\partial F_4}{\partial t} \quad (2.57 \text{ adapté}) $$
    </p>
    <p>
        La donnée au choix de l'une de ces quatre fonctions \( F_1, F_2, F_3, F_4 \) détermine donc complètement une transformation canonique. Si la fonction génératrice ne fait pas intervenir explicitement le temps (\( \partial F/\partial t = 0 \)), les fonctions de Hamilton coïncident dans les anciennes et les nouvelles représentations (\( H' = H \)). (Il existe en fait un lien très profond entre les transformations canoniques et les changements de représentation ou les transformations unitaires en mécanique quantique). Le choix immense des fonctions génératrices possibles donne une idée de la puissance de la méthode.
    </p>

    <h5>2.4.2 Transformations canoniques et crochets de Poisson</h5>
    <p>
        En fait la propriété essentielle des transformations canoniques est qu'elles conservent la forme des crochets de Poisson:
        $$ \{f, g\}_{q,p} = \{f, g\}_{Q,P}, \quad (2.58) $$
        où l'indice indique les variables par rapport auxquelles les dérivées sont prises:
        $$ \{f, g\}_{q,p} = \sum_i \left( \frac{\partial f}{\partial q_i} \frac{\partial g}{\partial p_i} - \frac{\partial f}{\partial p_i} \frac{\partial g}{\partial q_i} \right), \quad (2.59) $$
        et
        $$ \{f, g\}_{Q,P} = \sum_i \left( \frac{\partial f}{\partial Q_i} \frac{\partial g}{\partial P_i} - \frac{\partial f}{\partial P_i} \frac{\partial g}{\partial Q_i} \right). \quad (2.60) $$
        Cette invariance des crochets de Poisson est une définition équivalente de la canonicité d'une transformation.
    </p>
    <p>
        On peut bien sûr démontrer cette relation en utilisant la fonction génératrice de la transformation. Il existe cependant une démonstration beaucoup plus intuitive. Limitons nous pour cela au cas où \( f \) et \( g \) ne dépendent pas explicitement du temps et au cas où la fonction génératrice de la transformation ne dépend pas non plus du temps (\( H'=H \)). Il doit exister un problème de mécanique décrit par les \( q_i, p_i \) dont la
    </p>

     <!-- ===================================================================== -->
    <!-- Page 55 -->
    <!-- ===================================================================== -->
     <p>
        fonction \( g(p_i, q_i) \) serait le hamiltonien. Le crochet de Poisson \( \{f, g\}_{q,p} \) apparaît alors comme la dérivée temporelle \( df/dt \) de la fonction \( f \) le long d'une trajectoire solution de ce problème fictif. La fonction \( g(P_i, Q_i) \) est le hamiltonien \( H' \) du même problème dans les coordonnées transformées (car H'=H si F ne dépend pas de t). Le crochet de Poisson \( \{f, g\}_{Q,P} \) est la dérivée temporelle de \( f \) dans cette représentation. Mais \( df/dt \) doit être indépendante de la représentation, ce qui implique l'égalité des crochets de Poisson. Cette relation, établie ici dans un cas un peu particulier, est en fait générale. Elle permet, par exemple, de calculer facilement les crochets de poisson des nouvelles variables dans la représentation des anciennes, ce que nous laisserons au lecteur à titre d'exercice.
     </p>

    <h5>2.4.3 Exemples de transformations canoniques</h5>
    <p>
        Nous donnons ici, à titre d'illustration, quelques fonctions génératrices définissant des transformations canoniques particulièrement simples. Nous montrerons aussi comment les transformations canoniques permettent de rendre triviale la solution d'un problème de mécanique.
    </p>
    <ul>
        <li>\( F_2(q_i, P_i, t) = \sum_i q_i P_i \). Les équations (2.55) sont \( p_i = \partial F_2 / \partial q_i = P_i \) et \( Q_i = \partial F_2 / \partial P_i = q_i \). Le temps n'intervenant pas dans la fonction génératrice, nous avons bien sûr \( H' = H \). Cette fonction génératrice définit donc la <strong>transformation unité</strong>, ce qui ne présente guère d'intérêt.</li>
        <li>\( F_2(q_i, P_i, t) = \sum_i \phi_i(q_j, t) P_i \). Là encore, \( H'=H + \sum_i (\partial \phi_i / \partial t) P_i \). On trouve sans difficultés \( Q_i = \partial F_2 / \partial P_i = \phi_i(q_j, t) \). Cette fonction génère donc l'ensemble des <strong>transformations ponctuelles</strong>, éventuellement dépendantes du temps, qui définissent les nouvelles coordonnées \( Q_i \) en fonction seulement des anciennes \( q_j \). L'avantage de l'approche en termes de transformations canoniques est que l'application des autres relations aux dérivées partielles nous donne \( p_i = \partial F_2 / \partial q_i = \sum_k (\partial \phi_k / \partial q_i) P_k \), système qui permet de déterminer les nouvelles impulsions \( P_k \) en fonction des anciennes \( q_i, p_i \) et des coordonnées. Notons que, si les \( \phi_i \) dépendent du temps, les deux hamiltoniens \( H \) et \( H' \) peuvent différer.</li>
        <li>\( F_1(q_i, Q_i) = \sum_i q_i Q_i \). On trouve alors immédiatement \( p_i = \partial F_1 / \partial q_i = Q_i \) et \( P_i = -\partial F_1 / \partial Q_i = -q_i \). À un signe près, cette fonction réalise l'<strong>échange</strong> des coordonnées et des impulsions, illustrant le rôle très symétrique que jouent ces notions dans l'approche hamiltonienne. \( H'=H \) car F ne dépend pas de t.</li>
    </ul>
    <p>
        Nous allons montrer maintenant comment une transformation canonique bien choisie permet de rendre complètement triviale la dynamique d'un système. L'idée est de rendre le nouveau hamiltonien \( H' \) cyclique dans les nouvelles coordonnées \( Q_i, P_i \) (i.e., \( H' \) ne dépend pas de \( Q_i, P_i \)). Les nouvelles impulsions et positions sont alors constantes (\( \dot{P}_i = -\partial H'/\partial Q_i = 0 \), \( \dot{Q}_i = \partial H'/\partial P_i = 0 \)) ou évoluent simplement. Par exemple si \( H' \) ne dépend que des \( P_i \), alors \( \dot{P}_i = 0 \) (les P sont constants) et \( \dot{Q}_i = \partial H'/\partial P_i = \omega_i \), constantes. La dynamique des nouvelles coordonnées se résume à une évolution linéaire dans le temps \( Q_i = \omega_i t + \text{cste} \). La difficulté dans ce genre d'approche, à la base de nombreuses méthodes de résolution de problèmes de mécanique, est bien sûr d'exhiber la transformation canonique convenable, ce qui n'est pas toujours possible. Nous considérerons dans ce paragraphe le problème trivial d'un oscillateur harmonique à une dimension.
    </p>
    <p>
        Le hamiltonien \( H \) s'exprime simplement en fonction de la coordonnée \( q \) et de l'impulsion conjuguée \( p \) par:
        $$ H = \frac{p^2}{2m} + \frac{m\omega^2}{2}q^2 , \quad (2.61) $$
        somme des énergies cinétiques et potentielles. On considère alors la transformation canonique générée par la fonction (de type F1):
        $$ F_1(q, Q, t) = \frac{m\omega q^2}{2} \cot Q \quad (2.62) $$
        (le choix d'une telle transformation n'est guère possible si on ne connaît déjà la solution du problème). Cette fonction ne dépendant pas explicitement du temps, le nouveau et l'ancien hamiltonien coïncident \( H'=H \). A partir de cette fonction génératrice, on trouve
        $$ p = \frac{\partial F_1}{\partial q} = m\omega q \cot Q \quad (2.63) $$
    </p>

     <!-- ===================================================================== -->
    <!-- Page 56 -->
    <!-- ===================================================================== -->
    <p>et la nouvelle impulsion P:</p>
        $$ P = -\frac{\partial F_1}{\partial Q} = - \frac{m\omega q^2}{2} (-\frac{1}{\sin^2 Q}) = \frac{m\omega q^2}{2 \sin^2 Q} \quad (2.64) $$
    <p>On peut extraire de ces deux relations:</p>
        $$ q = \sqrt{\frac{2P \sin^2 Q}{m\omega}} = \sqrt{\frac{2P}{m\omega}} \sin Q, \quad p = m\omega q \cot Q = m\omega \sqrt{\frac{2P}{m\omega}} \sin Q \frac{\cos Q}{\sin Q} = \sqrt{2m\omega P} \cos Q \quad (2.65) $$
    <p>Le nouveau hamiltonien peut alors être exprimé, comme il se doit, en termes des nouvelles variables:</p>
        $$ H' = H = \frac{p^2}{2m} + \frac{m\omega^2 q^2}{2} = \frac{2m\omega P \cos^2 Q}{2m} + \frac{m\omega^2}{2} \frac{2P}{m\omega} \sin^2 Q $$
        $$ H' = \omega P (\cos^2 Q + \sin^2 Q) = \omega P . \quad (2.66) $$
    <p>
        Comme nous l'espérions, ce nouveau hamiltonien est cyclique dans la nouvelle coordonnée \( Q \). L'impulsion conjuguée, \( P \), est donc une constante. Comme l'énergie mécanique totale est conservée dans ce problème et coïncide avec la fonction de Hamilton, cette constante vaut simplement:
        $$ P = \frac{H}{\omega} = \frac{E}{\omega} \quad (2.67) $$
        Elle est donc homogène à une action (produit d'une énergie par un temps). \( P \) s'appelle donc <strong>variable d'action</strong>. On montre que, dans tout problème unidimensionnel périodique, on peut trouver une variable d'action conservée dans l'évolution. L'équation de Hamilton pour \( Q \), \( \dot{Q} = \partial H' / \partial P = \omega \), donne simplement:
        $$ Q = \omega t + \phi . \quad (2.68) $$
        \( Q \), évoluant linéairement avec le temps, se nomme <strong>variable d'angle</strong>. Là encore, dans tout problème unidimensionnel périodique, il existe une variable d'angle conjuguée de la variable d'action. La solution explicite du problème est donc donnée en fonction de deux constantes arbitraires, comme il se doit, l'énergie mécanique totale \( E = \omega P \) et la phase \( \phi \), valeur initiale de la nouvelle coordonnée. En utilisant alors la transformation (2.65), on peut exprimer la solution en termes des variables initiales, et on trouve:
        $$ q = \sqrt{\frac{2P}{m\omega}} \sin Q = \sqrt{\frac{2E}{m\omega^2}} \sin(\omega t + \phi), \quad (2.69) $$
        ce qui n'est pas vraiment un résultat inattendu!
    </p>
    <p>
        L'apparente simplicité de cette approche, dans ce cas trivial, ne doit pas faire oublier que la grande difficulté est d'exhiber la fonction génératrice adaptée. Nous ne pourrons aborder ici les méthodes variées de résolution fondées sur les transformations canoniques (comme la théorie de Hamilton-Jacobi ou la théorie des perturbations canoniques). Le lecteur pourra en trouver une description détaillée dans le Goldstein.
    </p>

    <h5>2.4.4 Transformations canoniques et espace des phases</h5>
    <p>
        L'état mécanique du système est complètement décrit par la donnée des \( n \) \( q_i \) et des \( n \) \( p_i \). Autrement dit, le système est décrit comme un point dans un espace à \( 2n \) dimensions que l'on appelle <strong>espace des phases</strong>. Cet espace joue un très grand rôle en physique statistique. L'entropie, par exemple, peut être définie comme le logarithme du nombre de configurations (micro-états) accessibles au système. Compter ce nombre de configurations, c'est compter le "volume" de l'espace des phases correspondant à un petit intervalle d'énergie. L'espace des phases joue également un rôle très important dans l'étude de la dynamique complexe des système (chaos classique, par exemple). Un point d'équilibre stable correspond à un point fixe dans l'espace des phases, un mouvement périodique à une trajectoire fermée simple, un mouvement chaotique à une trajectoire complexe parcourant rapidement tout le domaine accessible.
    </p>
    <p>
        Les transformations canoniques transforment un espace des phases en un autre. La géométrie de cette transformation n'est pas complètement arbitraire, en raison des contraintes imposées aux
    </p>

     <!-- ===================================================================== -->
    <!-- Page 57 -->
    <!-- ===================================================================== -->
    <p>
        transformations canoniques. La propriété essentielle est qu'une transformation canonique conserve le <strong>volume dans l'espace des phases</strong>. Si on considère un domaine \( V \) de l'espace des phases des "anciennes coordonnées" \( (q, p) \), il lui correspond un domaine \( V' \) dans le nouvel espace \( (Q, P) \). Pour des raisons évidentes de continuité et dérivabilité des transformations canoniques, \( V' \) est un fermé connexe si \( V \) l'est. On peut calculer le volume \( V \) du domaine \( V \) comme:
        $$ V = \int_V dq_1 \ldots dq_n dp_1 \ldots dp_n, \quad (2.70) $$
        et calculer de même le volume \( V' \) du domaine \( V' \).
        Pour une transformation canonique, \( V = V' \).
    </p>
    <p>
        Pour les mathématiciens cette propriété découle de façon immédiate de la structure symplectique de la transformation canonique. Nous allons établir cette propriété de façon moins directe, mais peut être plus accessible. Rappelons d'abord que le volume élémentaire se transforme selon:
        $$ dV' = dQ_1 \ldots dQ_n dP_1 \ldots dP_n = |J| dq_1 \ldots dq_n dp_1 \ldots dp_n = |J| dV, \quad (2.71 \text{ adapté}) $$
        où \( J \) est le <strong>Jacobien</strong> du changement de variable, déterminant formé avec toutes les dérivées partielles des nouvelles variables par rapport aux anciennes:
        $$ J = \det \begin{pmatrix} \frac{\partial Q_1}{\partial q_1} & \cdots & \frac{\partial Q_1}{\partial p_n} \\ \vdots & \ddots & \vdots \\ \frac{\partial P_n}{\partial q_1} & \cdots & \frac{\partial P_n}{\partial p_n} \end{pmatrix} \quad (2.72 \text{ adapté}) $$
        que nous noterons également
        $$ J = \frac{\partial(Q_1, \ldots, Q_n, P_1, \ldots, P_n)}{\partial(q_1, \ldots, q_n, p_1, \ldots, p_n)} = \frac{\partial(Q, P)}{\partial(q, p)} \quad (2.73 \text{ adapté}) $$
    </p>
    <p>
        Ces notations deviennent tout à fait triviales en dimension 1 et coïncident alors avec les changements de variables standard dans les intégrales. Si nous prouvons que le Jacobien de toute transformation canonique est 1 (en module), nous aurons établi la proposition cherchée (conservation du volume).
    </p>
    <p>
        Pour cela, nous aurons besoin de deux propriétés des Jacobiens. D'abord, la règle de composition (analogue à la règle des dérivées en chaîne):
        $$ \frac{\partial(Q, P)}{\partial(q, p)} = \frac{\partial(Q, P)}{\partial(x, y)} \frac{\partial(x, y)}{\partial(q, p)} \quad (2.74 \text{ généralisation}) $$
    </p>
    <p>
        En fait, comme les dérivées partielles ordinaires, les produits et rapports de Jacobiens peuvent se simplifier comme des fractions<sup>5</sup>. De plus, si on considère une transformation qui ne change que certaines variables, par exemple \( Q_i(q_j) \) et \( P_i = p_i \):
        $$ \frac{\partial(Q_1, \ldots, Q_n, p_1, \ldots, p_n)}{\partial(q_1, \ldots, q_n, p_1, \ldots, p_n)} = \frac{\partial(Q_1, \ldots, Q_n)}{\partial(q_1, \ldots, q_n)} \quad (2.75 \text{ adapté}) $$
        On peut donc retirer d'un Jacobien les variables qui apparaissent au "numérateur" et au "dénominateur". Le changement de variables considéré laisse en effet invariantes ces quantités.
    </p>
    <p>
        En utilisant successivement ces deux propriétés, on met le Jacobien de la transformation canonique (\( q, p \to Q, P \)) sous la forme:
        $$ J = \frac{\partial(Q, P)}{\partial(q, p)} = \frac{\partial(Q, P)}{\partial(q, P)} \frac{\partial(q, P)}{\partial(q, p)} = \frac{\partial(Q_1, \ldots, Q_n)}{\partial(q_1, \ldots, q_n)} \bigg|_{P \text{ const}} \times \frac{\partial(P_1, \ldots, P_n)}{\partial(p_1, \ldots, p_n)} \bigg|_{q \text{ const}} \quad (2.76) $$
    </p>
    <p class="footnote">
        <sup>5</sup> Nous supposons bien sûr que tous les Jacobiens écrits dans ces équations ont un sens, et en particulier que toutes les transformations "tronquées" sont inversibles, ce qui n'est pas vrai en toute généralité.
    </p>

     <!-- ===================================================================== -->
    <!-- Page 58 -->
    <!-- ===================================================================== -->
    <p>
        La transformation canonique étant engendrée par une fonction \( \Phi(q_i, P_i) = F_2(q_i, P_i) \) (pour simplifier, on suppose qu'elle ne dépend pas de t), telle que \( p_i = \partial \Phi / \partial q_i \) et \( Q_i = \partial \Phi / \partial P_i \). On a donc immédiatement les éléments de matrice pour les Jacobians partiels:
        $$ \frac{\partial Q_i}{\partial q_j} \bigg|_{P \text{ const}} = \frac{\partial}{\partial q_j} \left( \frac{\partial \Phi}{\partial P_i} \right) = \frac{\partial^2 \Phi}{\partial q_j \partial P_i} \quad (2.77 \text{ adapté}) $$
        et
        $$ \frac{\partial p_i}{\partial P_j} \bigg|_{q \text{ const}} = \frac{\partial}{\partial P_j} \left( \frac{\partial \Phi}{\partial q_i} \right) = \frac{\partial^2 \Phi}{\partial P_j \partial q_i} \quad (2.78 \text{ adapté}) $$
    </p>
    <p>
        Les dérivées secondes croisées étant égales, la matrice \( (\partial Q_i / \partial q_j)_P \) est la transposée de la matrice \( (\partial p_i / \partial P_j)_q \). Par conséquent, leurs déterminants sont égaux.
        $$ \det \left( \frac{\partial Q}{\partial q} \right)_P = \det \left( \frac{\partial p}{\partial P} \right)_q $$
        Or, le Jacobien \( \frac{\partial(P)}{\partial(p)} \big|_q \) est l'inverse du Jacobien \( \frac{\partial(p)}{\partial(P)} \big|_q \). Donc,
        $$ J = \det \left( \frac{\partial Q}{\partial q} \right)_P \times \left[ \det \left( \frac{\partial p}{\partial P} \right)_q \right]^{-1} = \det \left( \frac{\partial p}{\partial P} \right)_q \times \left[ \det \left( \frac{\partial p}{\partial P} \right)_q \right]^{-1} = 1 $$
        Cela établit que le Jacobien d'une transformation canonique est de module égal à un (\( J = \pm 1 \)) et l'invariance du volume dans l'espace des phases (théorème de Liouville).
    </p>

    <h5>2.4.5 Transformation générée par l'action et théorème de Liouville</h5>
    <p>
        Nous considérerons dans ce paragraphe une transformation canonique très particulière qui fait se correspondre deux états du système à deux instants différents. Considérons en effet un système ayant un lagrangien indépendant du temps (l'énergie totale \( H \) est donc conservée) dont la dynamique est décrite par les \( p_i(t) \) et les \( q_i(t) \) et considérons le changement de variables défini par:
        $$ p_i(t) \to P_i(t) = p_i(t + T) \quad (2.79) $$
        $$ q_i(t) \to Q_i(t) = q_i(t + T) \quad (2.80) $$
        où \( T \) est une durée fixe. Cette correspondance entre états du système à des instants différents est évidemment une transformation canonique, puisque les nouvelles variables \( (Q, P) \) obéissent aux mêmes équations du mouvement (de Hamilton) que les anciennes \( (q, p) \) (car H est indépendant du temps). Nous allons voir que la fonction génératrice de cette transformation n'est autre que l'action \( S \).
    </p>
    <p>
        Considérons en effet la trajectoire du système entre les instants \( t \) et \( t+T \) et une trajectoire infiniment voisine obtenue en modifiant les coordonnées aux points de départ et d'arrivée de quantités infinitésimales. Avec les résultats du chapitre précédent (section 1.6), nous pouvons écrire la variation de l'action \( S = \int_t^{t+T} L dt \) entre ces deux trajectoires comme:
        $$ dS = \sum_i p_i(t + T) d q_i(t + T) - \sum_i p_i(t) d q_i(t) \quad (2.81) $$
        ou encore, en utilisant les notations (2.79-80):
        $$ dS = \sum_i P_i(t) d Q_i(t) - \sum_i p_i(t) d q_i(t) . \quad (2.82) $$
    </p>
    <p>
        Cette expression de la différentielle de l'action, que nous pouvons considérer comme une fonction des coordonnées des points de départ et d'arrivée: \( S(q_i(t), Q_i(t)) \), prouve que \( S \) est la fonction génératrice de type \( F_1(q, Q) \) pour cette transformation:
        $$ \frac{\partial S}{\partial Q_i} = P_i, \quad \frac{\partial S}{\partial q_i} = -p_i . \quad (2.83) $$
        \( S \) est donc bien fonction génératrice de la transformation des \( q_i \) en \( Q_i \). Cette transformation joue un rôle central dans la méthode de Hamilton-Jacobi, essentielle pour la résolution de problèmes complexes, et conduisant à la notion importante de séparabilité des variables. Nous ne disposons pas d'un espace suffisant pour traiter convenablement cette méthode. Nous donnerons donc une seule application de la transformation engendrée par l'action.
    </p>
    <p>
        Considérons un domaine \( V \) de l'espace des phases du système. On peut considérer l'ensemble des trajectoires originaires d'un point situé à l'instant \( t \) à l'intérieur de ce domaine. Par continuité, ces trajectoires correspondent à l'instant \( t+T \) à des points situés dans un nouveau domaine \( V' \) de l'espace des phases. Comme la transformation faisant se correspondre les instants \( t \) et \( t+T \) est canonique,
    </p>

    <!-- ===================================================================== -->
    <!-- Page 59 -->
    <!-- ===================================================================== -->
    <p>
        l'étendue du domaine \( V' \) est égale à celle du domaine \( V \). Cette propriété constitue le <strong>théorème de Liouville</strong>:
    </p>
    <blockquote>
        Le volume du domaine occupé dans l'espace des phases par un ensemble de trajectoires se conserve au cours du temps.
    </blockquote>
    <p>
        Ce théorème joue évidemment un rôle important en mécanique statistique. Il prédit, par exemple, la conservation de l'entropie (microcanonique, \( S = k_B \ln \Omega \), où \( \Omega \) est le volume de l'espace des phases accessible) dans une évolution hamiltonienne. Notons que ce théorème ne tient pas en présence de dissipation. N'importe quelle condition initiale conduit en effet à un état de repos où les coordonnées n'évoluent plus (volume nul dans l'espace des phases). Soulignons aussi le lien entre ce théorème et le théorème de conservation de l'étendue en optique. L'étendue joue le rôle du volume dans un espace des phases {position des rayons / angle}.
    </p>
    <p>
        Ce paragraphe clôt notre exposé de mécanique analytique. Nous n'avons pas, de loin, donné un exposé exhaustif de ce sujet. Les grands domaines que nous n'aborderons pas sont les méthodes de résolution, telles que la méthode de Hamilton-Jacobi. Nous ne dirons rien, non plus, des méthodes de perturbations classiques, si utiles en astronomie. Nous évoquerons brièvement dans la prochaine partie les extensions du formalisme lagrangien à des coordonnées continues (en un mot à des champs), mais sans épuiser non plus ce très vaste sujet. Finalement, nous ne saurions trop recommander au lecteur de se rapporter aux manuels de mécanique quantique pour explorer les liens très profonds entre mécanique quantique et mécanique analytique. Si une présentation de la mécanique quantique à partir de la dynamique classique et de sa quantification canonique n'est pas à recommander pour une première approche de la mécanique quantique, elle est extrêmement enrichissante à un niveau plus avancé.
    </p>

    <!-- ===================================================================== -->
    <!-- Page 60 -->
    <!-- ===================================================================== -->
    <!-- Page vide -->

    <!-- ===================================================================== -->
    <!-- Page 61 -->
    <!-- ===================================================================== -->
    <h1>Appendice 1</h1>
    <h2>Modèle de Bohr</h2>

    <p>
        Nous traiterons dans cet appendice du premier modèle réaliste de structure atomique, celui de Bohr en 1913. Il nous sera en effet nécessaire à plusieurs endroits du cours pour des discussions qualitatives du rayonnement atomique. Comme ce modèle fait explicitement référence aux concepts d'action et a donné lieu, au cours de son évolution, à des développements élégants de mécanique classique, il a tout naturellement sa place dans ce cours de mécanique analytique. Nous commencerons par un bref rappel de la situation historique au moment de la formulation du modèle de Bohr. Nous l'exposerons ensuite dans un deuxième paragraphe. Dans un dernier paragraphe, nous préciserons ses limitations et les tentatives, menées entre autres par Bohr et Sommerfeld, pour raffiner le modèle et l'appliquer à d'autres atomes que l'hydrogène. Enfin, nous rappellerons brièvement, pour mémoire, les résultats quantiques rigoureux.
    </p>

    <h3>1.1 Un peu d'histoire</h3>
    <p>
        Les difficultés de la mécanique classique et les débuts de la mécanique quantique, au tournant du siècle, sont dues à essentiellement deux problèmes: le rayonnement du corps noir et la structure des spectres d'émission ou d'absorption des vapeurs.
    </p>
    <p>
        Quand on traite en thermodynamique classique le rayonnement d'un corps complètement absorbant (corps noir) en équilibre thermique, on trouve la célèbre loi de Rayleigh-Jeans. La densité de puissance spectrale du rayonnement (quantité d'énergie par unité de volume et de fréquence) est proportionnelle au carré de la fréquence (\( \rho(\nu) \propto \nu^2 \)). La quantité totale d'énergie électromagnétique contenue dans un corps en équilibre devrait donc être gravement infinie (\( \int \rho(\nu) d\nu \to \infty \)). C'est la "catastrophe ultraviolette". Ce n'est bien sûr pas le cas et les données expérimentales, relativement précises à la fin du siècle dernier, donnaient un spectre décroissant rapidement à haute fréquence. Pour expliquer ce spectre, Planck introduisit, en 1900, une hypothèse de quantification. Les échanges d'énergie entre matière et rayonnement ne peuvent se faire, à une fréquence donnée \( \nu \), que par multiples entiers d'une quantité fondamentale, proportionnelle à la fréquence, selon la fameuse relation \( E = h\nu \). La constante de Planck, \( h \), une fois ajustée aux données expérimentales, l'accord entre les spectres calculés et les spectres expérimentaux se révélait excellent. En fait, Planck considérait cette hypothèse comme heuristique et doutait de sa signification physique. Ce n'est qu'avec Einstein, 5 ans plus tard, que l'idée de quantification de l'énergie électromagnétique fit
